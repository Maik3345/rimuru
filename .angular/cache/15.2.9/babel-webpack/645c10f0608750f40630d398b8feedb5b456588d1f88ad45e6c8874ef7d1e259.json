{"ast":null,"code":"function _toArray(arr) {\n  return _arrayWithHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableRest();\n}\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n  return arr2;\n}\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _s, _e;\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n  return _arr;\n}\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.object.from-entries.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.object.entries.js\";\nimport \"core-js/modules/es.object.assign.js\";\nimport \"core-js/modules/es.number.is-integer.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.search.js\";\nimport \"core-js/modules/es.promise.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.object.values.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/web.url.js\";\nimport \"core-js/modules/web.url-search-params.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.array.from.js\";\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\nimport global from 'global';\nimport * as EVENTS from '@storybook/core-events';\nimport Channel from '@storybook/channels';\nimport { logger, pretty } from '@storybook/client-logger';\nimport { isJSON, parse, stringify } from 'telejson';\nimport qs from 'qs';\nvar globalWindow = global.window,\n  document = global.document,\n  location = global.location;\nexport var KEY = 'storybook-channel';\nvar defaultEventOptions = {\n  allowFunction: true,\n  maxDepth: 25\n}; // TODO: we should export a method for opening child windows here and keep track of em.\n// that way we can send postMessage to child windows as well, not just iframe\n// https://stackoverflow.com/questions/6340160/how-to-get-the-references-of-all-already-opened-child-windows\n\nexport var PostmsgTransport = /*#__PURE__*/function () {\n  function PostmsgTransport(config) {\n    _classCallCheck(this, PostmsgTransport);\n    this.config = config;\n    this.buffer = void 0;\n    this.handler = void 0;\n    this.connected = void 0;\n    this.buffer = [];\n    this.handler = null;\n    globalWindow.addEventListener('message', this.handleEvent.bind(this), false); // Check whether the config.page parameter has a valid value\n\n    if (config.page !== 'manager' && config.page !== 'preview') {\n      throw new Error(\"postmsg-channel: \\\"config.page\\\" cannot be \\\"\".concat(config.page, \"\\\"\"));\n    }\n  }\n  _createClass(PostmsgTransport, [{\n    key: \"setHandler\",\n    value: function setHandler(handler) {\n      var _this = this;\n      this.handler = function () {\n        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n          args[_key] = arguments[_key];\n        }\n        handler.apply(_this, args);\n        if (!_this.connected && _this.getLocalFrame().length) {\n          _this.flush();\n          _this.connected = true;\n        }\n      };\n    }\n    /**\n     * Sends `event` to the associated window. If the window does not yet exist\n     * the event will be stored in a buffer and sent when the window exists.\n     * @param event\n     */\n  }, {\n    key: \"send\",\n    value: function send(event, options) {\n      var _this2 = this;\n      var _ref = options || {},\n        target = _ref.target,\n        allowRegExp = _ref.allowRegExp,\n        allowFunction = _ref.allowFunction,\n        allowSymbol = _ref.allowSymbol,\n        allowDate = _ref.allowDate,\n        allowUndefined = _ref.allowUndefined,\n        allowClass = _ref.allowClass,\n        maxDepth = _ref.maxDepth,\n        space = _ref.space,\n        lazyEval = _ref.lazyEval;\n      var eventOptions = Object.fromEntries(Object.entries({\n        allowRegExp: allowRegExp,\n        allowFunction: allowFunction,\n        allowSymbol: allowSymbol,\n        allowDate: allowDate,\n        allowUndefined: allowUndefined,\n        allowClass: allowClass,\n        maxDepth: maxDepth,\n        space: space,\n        lazyEval: lazyEval\n      }).filter(function (_ref2) {\n        var _ref3 = _slicedToArray(_ref2, 2),\n          k = _ref3[0],\n          v = _ref3[1];\n        return typeof v !== 'undefined';\n      }));\n      var stringifyOptions = Object.assign({}, defaultEventOptions, global.CHANNEL_OPTIONS || {}, eventOptions); // backwards compat: convert depth to maxDepth\n\n      if (options && Number.isInteger(options.depth)) {\n        stringifyOptions.maxDepth = options.depth;\n      }\n      var frames = this.getFrames(target);\n      var query = qs.parse(location.search, {\n        ignoreQueryPrefix: true\n      });\n      var data = stringify({\n        key: KEY,\n        event: event,\n        refId: query.refId\n      }, stringifyOptions);\n      if (!frames.length) {\n        return new Promise(function (resolve, reject) {\n          _this2.buffer.push({\n            event: event,\n            resolve: resolve,\n            reject: reject\n          });\n        });\n      }\n      if (this.buffer.length) {\n        this.flush();\n      }\n      frames.forEach(function (f) {\n        try {\n          f.postMessage(data, '*');\n        } catch (e) {\n          console.error('sending over postmessage fail');\n        }\n      });\n      return Promise.resolve(null);\n    }\n  }, {\n    key: \"flush\",\n    value: function flush() {\n      var _this3 = this;\n      var buffer = this.buffer;\n      this.buffer = [];\n      buffer.forEach(function (item) {\n        _this3.send(item.event).then(item.resolve).catch(item.reject);\n      });\n    }\n  }, {\n    key: \"getFrames\",\n    value: function getFrames(target) {\n      if (this.config.page === 'manager') {\n        var nodes = _toConsumableArray(document.querySelectorAll('iframe[data-is-storybook][data-is-loaded]'));\n        var list = nodes.filter(function (e) {\n          try {\n            return !!e.contentWindow && e.dataset.isStorybook !== undefined && e.id === target;\n          } catch (er) {\n            return false;\n          }\n        }).map(function (e) {\n          return e.contentWindow;\n        });\n        return list.length ? list : this.getCurrentFrames();\n      }\n      if (globalWindow && globalWindow.parent && globalWindow.parent !== globalWindow) {\n        return [globalWindow.parent];\n      }\n      return [];\n    }\n  }, {\n    key: \"getCurrentFrames\",\n    value: function getCurrentFrames() {\n      if (this.config.page === 'manager') {\n        var list = _toConsumableArray(document.querySelectorAll('[data-is-storybook=\"true\"]'));\n        return list.map(function (e) {\n          return e.contentWindow;\n        });\n      }\n      if (globalWindow && globalWindow.parent) {\n        return [globalWindow.parent];\n      }\n      return [];\n    }\n  }, {\n    key: \"getLocalFrame\",\n    value: function getLocalFrame() {\n      if (this.config.page === 'manager') {\n        var list = _toConsumableArray(document.querySelectorAll('#storybook-preview-iframe'));\n        return list.map(function (e) {\n          return e.contentWindow;\n        });\n      }\n      if (globalWindow && globalWindow.parent) {\n        return [globalWindow.parent];\n      }\n      return [];\n    }\n  }, {\n    key: \"handleEvent\",\n    value: function handleEvent(rawEvent) {\n      try {\n        var data = rawEvent.data;\n        var _ref4 = typeof data === 'string' && isJSON(data) ? parse(data, global.CHANNEL_OPTIONS || {}) : data,\n          key = _ref4.key,\n          event = _ref4.event,\n          refId = _ref4.refId;\n        if (key === KEY) {\n          var pageString = this.config.page === 'manager' ? \"<span style=\\\"color: #37D5D3; background: black\\\"> manager </span>\" : \"<span style=\\\"color: #1EA7FD; background: black\\\"> preview </span>\";\n          var eventString = Object.values(EVENTS).includes(event.type) ? \"<span style=\\\"color: #FF4785\\\">\".concat(event.type, \"</span>\") : \"<span style=\\\"color: #FFAE00\\\">\".concat(event.type, \"</span>\");\n          if (refId) {\n            event.refId = refId;\n          }\n          event.source = this.config.page === 'preview' ? rawEvent.origin : getEventSourceUrl(rawEvent);\n          if (!event.source) {\n            pretty.error(\"\".concat(pageString, \" received \").concat(eventString, \" but was unable to determine the source of the event\"));\n            return;\n          }\n          var message = \"\".concat(pageString, \" received \").concat(eventString, \" (\").concat(data.length, \")\");\n          pretty.debug.apply(pretty, [location.origin !== event.source ? message : \"\".concat(message, \" <span style=\\\"color: gray\\\">(on \").concat(location.origin, \" from \").concat(event.source, \")</span>\")].concat(_toConsumableArray(event.args)));\n          this.handler(event);\n        }\n      } catch (error) {\n        logger.error(error);\n      }\n    }\n  }]);\n  return PostmsgTransport;\n}();\nvar getEventSourceUrl = function getEventSourceUrl(event) {\n  var frames = _toConsumableArray(document.querySelectorAll('iframe[data-is-storybook]')); // try to find the originating iframe by matching it's contentWindow\n  // This might not be cross-origin safe\n\n  var _frames$filter = frames.filter(function (element) {\n      try {\n        return element.contentWindow === event.source;\n      } catch (err) {// continue\n      }\n      var src = element.getAttribute('src');\n      var origin;\n      try {\n        var _URL = new URL(src, document.location);\n        origin = _URL.origin;\n      } catch (err) {\n        return false;\n      }\n      return origin === event.origin;\n    }),\n    _frames$filter2 = _toArray(_frames$filter),\n    frame = _frames$filter2[0],\n    remainder = _frames$filter2.slice(1);\n  if (frame && remainder.length === 0) {\n    var src = frame.getAttribute('src');\n    var _URL2 = new URL(src, document.location),\n      protocol = _URL2.protocol,\n      host = _URL2.host,\n      pathname = _URL2.pathname;\n    return \"\".concat(protocol, \"//\").concat(host).concat(pathname);\n  }\n  if (remainder.length > 0) {\n    // If we found multiple matches, there's going to be trouble\n    logger.error('found multiple candidates for event source');\n  } // If we found no frames of matches\n\n  return null;\n};\n/**\n * Creates a channel which communicates with an iframe or child window.\n */\n\nexport default function createChannel(_ref5) {\n  var page = _ref5.page;\n  var transport = new PostmsgTransport({\n    page: page\n  });\n  return new Channel({\n    transport: transport\n  });\n}","map":{"version":3,"names":["_toArray","arr","_arrayWithHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableRest","_toConsumableArray","_arrayWithoutHoles","_nonIterableSpread","TypeError","iter","Symbol","iterator","Array","from","isArray","_arrayLikeToArray","_slicedToArray","i","_iterableToArrayLimit","o","minLen","n","Object","prototype","toString","call","slice","constructor","name","test","len","length","arr2","_i","_arr","_n","_d","_s","_e","next","done","push","value","err","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","key","_createClass","protoProps","staticProps","global","EVENTS","Channel","logger","pretty","isJSON","parse","stringify","qs","globalWindow","window","document","location","KEY","defaultEventOptions","allowFunction","maxDepth","PostmsgTransport","config","buffer","handler","connected","addEventListener","handleEvent","bind","page","Error","concat","setHandler","_this","_len","arguments","args","_key","apply","getLocalFrame","flush","send","event","options","_this2","_ref","allowRegExp","allowSymbol","allowDate","allowUndefined","allowClass","space","lazyEval","eventOptions","fromEntries","entries","filter","_ref2","_ref3","k","v","stringifyOptions","assign","CHANNEL_OPTIONS","Number","isInteger","depth","frames","getFrames","query","search","ignoreQueryPrefix","data","refId","Promise","resolve","reject","forEach","f","postMessage","e","console","error","_this3","item","then","catch","nodes","querySelectorAll","list","contentWindow","dataset","isStorybook","undefined","id","er","map","getCurrentFrames","parent","rawEvent","_ref4","pageString","eventString","values","includes","type","source","origin","getEventSourceUrl","message","debug","_frames$filter","element","src","getAttribute","_URL","URL","_frames$filter2","frame","remainder","_URL2","protocol","host","pathname","createChannel","_ref5","transport"],"sources":["/Users/michael.restrepo/code/personal/web-components/rimuru/node_modules/@storybook/channel-postmessage/dist/esm/index.js"],"sourcesContent":["function _toArray(arr) { return _arrayWithHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableRest(); }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.object.from-entries.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.object.entries.js\";\nimport \"core-js/modules/es.object.assign.js\";\nimport \"core-js/modules/es.number.is-integer.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.search.js\";\nimport \"core-js/modules/es.promise.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.object.values.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/web.url.js\";\nimport \"core-js/modules/web.url-search-params.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.array.from.js\";\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nimport global from 'global';\nimport * as EVENTS from '@storybook/core-events';\nimport Channel from '@storybook/channels';\nimport { logger, pretty } from '@storybook/client-logger';\nimport { isJSON, parse, stringify } from 'telejson';\nimport qs from 'qs';\nvar globalWindow = global.window,\n    document = global.document,\n    location = global.location;\nexport var KEY = 'storybook-channel';\nvar defaultEventOptions = {\n  allowFunction: true,\n  maxDepth: 25\n}; // TODO: we should export a method for opening child windows here and keep track of em.\n// that way we can send postMessage to child windows as well, not just iframe\n// https://stackoverflow.com/questions/6340160/how-to-get-the-references-of-all-already-opened-child-windows\n\nexport var PostmsgTransport = /*#__PURE__*/function () {\n  function PostmsgTransport(config) {\n    _classCallCheck(this, PostmsgTransport);\n\n    this.config = config;\n    this.buffer = void 0;\n    this.handler = void 0;\n    this.connected = void 0;\n    this.buffer = [];\n    this.handler = null;\n    globalWindow.addEventListener('message', this.handleEvent.bind(this), false); // Check whether the config.page parameter has a valid value\n\n    if (config.page !== 'manager' && config.page !== 'preview') {\n      throw new Error(\"postmsg-channel: \\\"config.page\\\" cannot be \\\"\".concat(config.page, \"\\\"\"));\n    }\n  }\n\n  _createClass(PostmsgTransport, [{\n    key: \"setHandler\",\n    value: function setHandler(handler) {\n      var _this = this;\n\n      this.handler = function () {\n        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n          args[_key] = arguments[_key];\n        }\n\n        handler.apply(_this, args);\n\n        if (!_this.connected && _this.getLocalFrame().length) {\n          _this.flush();\n\n          _this.connected = true;\n        }\n      };\n    }\n    /**\n     * Sends `event` to the associated window. If the window does not yet exist\n     * the event will be stored in a buffer and sent when the window exists.\n     * @param event\n     */\n\n  }, {\n    key: \"send\",\n    value: function send(event, options) {\n      var _this2 = this;\n\n      var _ref = options || {},\n          target = _ref.target,\n          allowRegExp = _ref.allowRegExp,\n          allowFunction = _ref.allowFunction,\n          allowSymbol = _ref.allowSymbol,\n          allowDate = _ref.allowDate,\n          allowUndefined = _ref.allowUndefined,\n          allowClass = _ref.allowClass,\n          maxDepth = _ref.maxDepth,\n          space = _ref.space,\n          lazyEval = _ref.lazyEval;\n\n      var eventOptions = Object.fromEntries(Object.entries({\n        allowRegExp: allowRegExp,\n        allowFunction: allowFunction,\n        allowSymbol: allowSymbol,\n        allowDate: allowDate,\n        allowUndefined: allowUndefined,\n        allowClass: allowClass,\n        maxDepth: maxDepth,\n        space: space,\n        lazyEval: lazyEval\n      }).filter(function (_ref2) {\n        var _ref3 = _slicedToArray(_ref2, 2),\n            k = _ref3[0],\n            v = _ref3[1];\n\n        return typeof v !== 'undefined';\n      }));\n      var stringifyOptions = Object.assign({}, defaultEventOptions, global.CHANNEL_OPTIONS || {}, eventOptions); // backwards compat: convert depth to maxDepth\n\n      if (options && Number.isInteger(options.depth)) {\n        stringifyOptions.maxDepth = options.depth;\n      }\n\n      var frames = this.getFrames(target);\n      var query = qs.parse(location.search, {\n        ignoreQueryPrefix: true\n      });\n      var data = stringify({\n        key: KEY,\n        event: event,\n        refId: query.refId\n      }, stringifyOptions);\n\n      if (!frames.length) {\n        return new Promise(function (resolve, reject) {\n          _this2.buffer.push({\n            event: event,\n            resolve: resolve,\n            reject: reject\n          });\n        });\n      }\n\n      if (this.buffer.length) {\n        this.flush();\n      }\n\n      frames.forEach(function (f) {\n        try {\n          f.postMessage(data, '*');\n        } catch (e) {\n          console.error('sending over postmessage fail');\n        }\n      });\n      return Promise.resolve(null);\n    }\n  }, {\n    key: \"flush\",\n    value: function flush() {\n      var _this3 = this;\n\n      var buffer = this.buffer;\n      this.buffer = [];\n      buffer.forEach(function (item) {\n        _this3.send(item.event).then(item.resolve).catch(item.reject);\n      });\n    }\n  }, {\n    key: \"getFrames\",\n    value: function getFrames(target) {\n      if (this.config.page === 'manager') {\n        var nodes = _toConsumableArray(document.querySelectorAll('iframe[data-is-storybook][data-is-loaded]'));\n\n        var list = nodes.filter(function (e) {\n          try {\n            return !!e.contentWindow && e.dataset.isStorybook !== undefined && e.id === target;\n          } catch (er) {\n            return false;\n          }\n        }).map(function (e) {\n          return e.contentWindow;\n        });\n        return list.length ? list : this.getCurrentFrames();\n      }\n\n      if (globalWindow && globalWindow.parent && globalWindow.parent !== globalWindow) {\n        return [globalWindow.parent];\n      }\n\n      return [];\n    }\n  }, {\n    key: \"getCurrentFrames\",\n    value: function getCurrentFrames() {\n      if (this.config.page === 'manager') {\n        var list = _toConsumableArray(document.querySelectorAll('[data-is-storybook=\"true\"]'));\n\n        return list.map(function (e) {\n          return e.contentWindow;\n        });\n      }\n\n      if (globalWindow && globalWindow.parent) {\n        return [globalWindow.parent];\n      }\n\n      return [];\n    }\n  }, {\n    key: \"getLocalFrame\",\n    value: function getLocalFrame() {\n      if (this.config.page === 'manager') {\n        var list = _toConsumableArray(document.querySelectorAll('#storybook-preview-iframe'));\n\n        return list.map(function (e) {\n          return e.contentWindow;\n        });\n      }\n\n      if (globalWindow && globalWindow.parent) {\n        return [globalWindow.parent];\n      }\n\n      return [];\n    }\n  }, {\n    key: \"handleEvent\",\n    value: function handleEvent(rawEvent) {\n      try {\n        var data = rawEvent.data;\n\n        var _ref4 = typeof data === 'string' && isJSON(data) ? parse(data, global.CHANNEL_OPTIONS || {}) : data,\n            key = _ref4.key,\n            event = _ref4.event,\n            refId = _ref4.refId;\n\n        if (key === KEY) {\n          var pageString = this.config.page === 'manager' ? \"<span style=\\\"color: #37D5D3; background: black\\\"> manager </span>\" : \"<span style=\\\"color: #1EA7FD; background: black\\\"> preview </span>\";\n          var eventString = Object.values(EVENTS).includes(event.type) ? \"<span style=\\\"color: #FF4785\\\">\".concat(event.type, \"</span>\") : \"<span style=\\\"color: #FFAE00\\\">\".concat(event.type, \"</span>\");\n\n          if (refId) {\n            event.refId = refId;\n          }\n\n          event.source = this.config.page === 'preview' ? rawEvent.origin : getEventSourceUrl(rawEvent);\n\n          if (!event.source) {\n            pretty.error(\"\".concat(pageString, \" received \").concat(eventString, \" but was unable to determine the source of the event\"));\n            return;\n          }\n\n          var message = \"\".concat(pageString, \" received \").concat(eventString, \" (\").concat(data.length, \")\");\n          pretty.debug.apply(pretty, [location.origin !== event.source ? message : \"\".concat(message, \" <span style=\\\"color: gray\\\">(on \").concat(location.origin, \" from \").concat(event.source, \")</span>\")].concat(_toConsumableArray(event.args)));\n          this.handler(event);\n        }\n      } catch (error) {\n        logger.error(error);\n      }\n    }\n  }]);\n\n  return PostmsgTransport;\n}();\n\nvar getEventSourceUrl = function getEventSourceUrl(event) {\n  var frames = _toConsumableArray(document.querySelectorAll('iframe[data-is-storybook]')); // try to find the originating iframe by matching it's contentWindow\n  // This might not be cross-origin safe\n\n\n  var _frames$filter = frames.filter(function (element) {\n    try {\n      return element.contentWindow === event.source;\n    } catch (err) {// continue\n    }\n\n    var src = element.getAttribute('src');\n    var origin;\n\n    try {\n      var _URL = new URL(src, document.location);\n\n      origin = _URL.origin;\n    } catch (err) {\n      return false;\n    }\n\n    return origin === event.origin;\n  }),\n      _frames$filter2 = _toArray(_frames$filter),\n      frame = _frames$filter2[0],\n      remainder = _frames$filter2.slice(1);\n\n  if (frame && remainder.length === 0) {\n    var src = frame.getAttribute('src');\n\n    var _URL2 = new URL(src, document.location),\n        protocol = _URL2.protocol,\n        host = _URL2.host,\n        pathname = _URL2.pathname;\n\n    return \"\".concat(protocol, \"//\").concat(host).concat(pathname);\n  }\n\n  if (remainder.length > 0) {\n    // If we found multiple matches, there's going to be trouble\n    logger.error('found multiple candidates for event source');\n  } // If we found no frames of matches\n\n\n  return null;\n};\n/**\n * Creates a channel which communicates with an iframe or child window.\n */\n\n\nexport default function createChannel(_ref5) {\n  var page = _ref5.page;\n  var transport = new PostmsgTransport({\n    page: page\n  });\n  return new Channel({\n    transport: transport\n  });\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}