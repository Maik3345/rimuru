{"ast":null,"code":"import _regeneratorRuntime from \"/Users/michael.restrepo/code/personal/web-components/rimuru/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/regenerator/index.js\";\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\nimport \"core-js/modules/es.object.get-prototype-of.js\";\nimport \"core-js/modules/es.reflect.construct.js\";\nimport \"core-js/modules/es.reflect.get.js\";\nimport \"core-js/modules/es.object.get-own-property-descriptor.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.object.freeze.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4;\nimport \"regenerator-runtime/runtime.js\";\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n      args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n      _next(undefined);\n    });\n  };\n}\nfunction _taggedTemplateLiteral(strings, raw) {\n  if (!raw) {\n    raw = strings.slice(0);\n  }\n  return Object.freeze(Object.defineProperties(strings, {\n    raw: {\n      value: Object.freeze(raw)\n    }\n  }));\n}\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\nfunction _get() {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n      if (desc.get) {\n        return desc.get.call(arguments.length < 3 ? target : receiver);\n      }\n      return desc.value;\n    };\n  }\n  return _get.apply(this, arguments);\n}\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n  return object;\n}\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n      result;\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n    return _possibleConstructorReturn(this, result);\n  };\n}\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n  return _assertThisInitialized(self);\n}\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n  return self;\n}\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.object.assign.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.promise.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport deprecate from 'util-deprecate';\nimport dedent from 'ts-dedent';\nimport global from 'global';\nimport { CURRENT_STORY_WAS_SET, IGNORED_EXCEPTION, PRELOAD_STORIES, PREVIEW_KEYDOWN, SET_CURRENT_STORY, SET_STORIES, STORY_ARGS_UPDATED, STORY_CHANGED, STORY_ERRORED, STORY_MISSING, STORY_PREPARED, STORY_RENDER_PHASE_CHANGED, STORY_SPECIFIED, STORY_THREW_EXCEPTION, STORY_UNCHANGED, UPDATE_QUERY_PARAMS } from '@storybook/core-events';\nimport { logger } from '@storybook/client-logger';\nimport { Preview } from './Preview';\nimport { UrlStore } from './UrlStore';\nimport { WebView } from './WebView';\nimport { PREPARE_ABORTED, StoryRender } from './StoryRender';\nimport { DocsRender } from './DocsRender';\nvar globalWindow = global.window;\nfunction focusInInput(event) {\n  var target = event.target;\n  return /input|textarea/i.test(target.tagName) || target.getAttribute('contenteditable') !== null;\n}\nexport var PreviewWeb = /*#__PURE__*/function (_Preview) {\n  _inherits(PreviewWeb, _Preview);\n  var _super = _createSuper(PreviewWeb);\n  function PreviewWeb() {\n    var _this;\n    var urlStore = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new UrlStore();\n    var webview = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new WebView();\n    _classCallCheck(this, PreviewWeb);\n    _this = _super.call(this);\n    _this.urlStore = void 0;\n    _this.view = void 0;\n    _this.previewEntryError = void 0;\n    _this.currentSelection = void 0;\n    _this.currentRender = void 0;\n    _this.view = webview;\n    _this.urlStore = urlStore; // Add deprecated APIs for back-compat\n    // @ts-ignore\n\n    _this.storyStore.getSelection = deprecate(function () {\n      return _this.urlStore.selection;\n    }, dedent(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n        `__STORYBOOK_STORY_STORE__.getSelection()` is deprecated and will be removed in 7.0.\\n  \\n        To get the current selection, use the `useStoryContext()` hook from `@storybook/addons`.\\n      \"], [\"\\n        \\\\`__STORYBOOK_STORY_STORE__.getSelection()\\\\` is deprecated and will be removed in 7.0.\\n  \\n        To get the current selection, use the \\\\`useStoryContext()\\\\` hook from \\\\`@storybook/addons\\\\`.\\n      \"]))));\n    return _this;\n  }\n  _createClass(PreviewWeb, [{\n    key: \"setupListeners\",\n    value: function setupListeners() {\n      _get(_getPrototypeOf(PreviewWeb.prototype), \"setupListeners\", this).call(this);\n      globalWindow.onkeydown = this.onKeydown.bind(this);\n      this.channel.on(SET_CURRENT_STORY, this.onSetCurrentStory.bind(this));\n      this.channel.on(UPDATE_QUERY_PARAMS, this.onUpdateQueryParams.bind(this));\n      this.channel.on(PRELOAD_STORIES, this.onPreloadStories.bind(this));\n    }\n  }, {\n    key: \"initializeWithProjectAnnotations\",\n    value: function initializeWithProjectAnnotations(projectAnnotations) {\n      var _this2 = this;\n      return _get(_getPrototypeOf(PreviewWeb.prototype), \"initializeWithProjectAnnotations\", this).call(this, projectAnnotations).then(function () {\n        return _this2.setInitialGlobals();\n      });\n    }\n  }, {\n    key: \"setInitialGlobals\",\n    value: function () {\n      var _setInitialGlobals = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _ref, globals;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _ref = this.urlStore.selectionSpecifier || {}, globals = _ref.globals;\n                if (globals) {\n                  this.storyStore.globals.updateFromPersisted(globals);\n                }\n                this.emitGlobals();\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n      function setInitialGlobals() {\n        return _setInitialGlobals.apply(this, arguments);\n      }\n      return setInitialGlobals;\n    }() // If initialization gets as far as the story index, this function runs.\n  }, {\n    key: \"initializeWithStoryIndex\",\n    value: function initializeWithStoryIndex(storyIndex) {\n      var _this3 = this;\n      return _get(_getPrototypeOf(PreviewWeb.prototype), \"initializeWithStoryIndex\", this).call(this, storyIndex).then(function () {\n        var _global$FEATURES;\n        if (!((_global$FEATURES = global.FEATURES) !== null && _global$FEATURES !== void 0 && _global$FEATURES.storyStoreV7)) {\n          _this3.channel.emit(SET_STORIES, _this3.storyStore.getSetStoriesPayload());\n        }\n        return _this3.selectSpecifiedStory();\n      });\n    } // Use the selection specifier to choose a story, then render it\n  }, {\n    key: \"selectSpecifiedStory\",\n    value: function () {\n      var _selectSpecifiedStory = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var _this$urlStore$select, storySpecifier, viewMode, args, storyId;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (this.urlStore.selectionSpecifier) {\n                  _context2.next = 3;\n                  break;\n                }\n                this.renderMissingStory();\n                return _context2.abrupt(\"return\");\n              case 3:\n                _this$urlStore$select = this.urlStore.selectionSpecifier, storySpecifier = _this$urlStore$select.storySpecifier, viewMode = _this$urlStore$select.viewMode, args = _this$urlStore$select.args;\n                storyId = this.storyStore.storyIndex.storyIdFromSpecifier(storySpecifier);\n                if (storyId) {\n                  _context2.next = 8;\n                  break;\n                }\n                if (storySpecifier === '*') {\n                  this.renderStoryLoadingException(storySpecifier, new Error(dedent(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\n            Couldn't find any stories in your Storybook.\\n            - Please check your stories field of your main.js config.\\n            - Also check the browser console and terminal for error messages.\\n          \"])))));\n                } else {\n                  this.renderStoryLoadingException(storySpecifier, new Error(dedent(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\\n            Couldn't find story matching '\", \"'.\\n            - Are you sure a story with that id exists?\\n            - Please check your stories field of your main.js config.\\n            - Also check the browser console and terminal for error messages.\\n          \"])), storySpecifier)));\n                }\n                return _context2.abrupt(\"return\");\n              case 8:\n                this.urlStore.setSelection({\n                  storyId: storyId,\n                  viewMode: viewMode\n                });\n                this.channel.emit(STORY_SPECIFIED, this.urlStore.selection);\n                this.channel.emit(CURRENT_STORY_WAS_SET, this.urlStore.selection);\n                _context2.next = 13;\n                return this.renderSelection({\n                  persistedArgs: args\n                });\n              case 13:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n      function selectSpecifiedStory() {\n        return _selectSpecifiedStory.apply(this, arguments);\n      }\n      return selectSpecifiedStory;\n    }() // EVENT HANDLERS\n    // This happens when a config file gets reloaded\n  }, {\n    key: \"onGetProjectAnnotationsChanged\",\n    value: function () {\n      var _onGetProjectAnnotationsChanged = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(_ref2) {\n        var getProjectAnnotations;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                getProjectAnnotations = _ref2.getProjectAnnotations;\n                _context3.next = 3;\n                return _get(_getPrototypeOf(PreviewWeb.prototype), \"onGetProjectAnnotationsChanged\", this).call(this, {\n                  getProjectAnnotations: getProjectAnnotations\n                });\n              case 3:\n                this.renderSelection();\n              case 4:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n      function onGetProjectAnnotationsChanged(_x) {\n        return _onGetProjectAnnotationsChanged.apply(this, arguments);\n      }\n      return onGetProjectAnnotationsChanged;\n    }() // This happens when a glob gets HMR-ed\n  }, {\n    key: \"onStoriesChanged\",\n    value: function () {\n      var _onStoriesChanged = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(_ref3) {\n        var _global$FEATURES2;\n        var importFn, storyIndex;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                importFn = _ref3.importFn, storyIndex = _ref3.storyIndex;\n                _get(_getPrototypeOf(PreviewWeb.prototype), \"onStoriesChanged\", this).call(this, {\n                  importFn: importFn,\n                  storyIndex: storyIndex\n                });\n                if ((_global$FEATURES2 = global.FEATURES) !== null && _global$FEATURES2 !== void 0 && _global$FEATURES2.storyStoreV7) {\n                  _context4.next = 9;\n                  break;\n                }\n                _context4.t0 = this.channel;\n                _context4.t1 = SET_STORIES;\n                _context4.next = 7;\n                return this.storyStore.getSetStoriesPayload();\n              case 7:\n                _context4.t2 = _context4.sent;\n                _context4.t0.emit.call(_context4.t0, _context4.t1, _context4.t2);\n              case 9:\n                if (!this.urlStore.selection) {\n                  _context4.next = 14;\n                  break;\n                }\n                _context4.next = 12;\n                return this.renderSelection();\n              case 12:\n                _context4.next = 16;\n                break;\n              case 14:\n                _context4.next = 16;\n                return this.selectSpecifiedStory();\n              case 16:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n      function onStoriesChanged(_x2) {\n        return _onStoriesChanged.apply(this, arguments);\n      }\n      return onStoriesChanged;\n    }()\n  }, {\n    key: \"onKeydown\",\n    value: function onKeydown(event) {\n      var _this$currentRender;\n      if (!((_this$currentRender = this.currentRender) !== null && _this$currentRender !== void 0 && _this$currentRender.disableKeyListeners) && !focusInInput(event)) {\n        // We have to pick off the keys of the event that we need on the other side\n        var altKey = event.altKey,\n          ctrlKey = event.ctrlKey,\n          metaKey = event.metaKey,\n          shiftKey = event.shiftKey,\n          key = event.key,\n          code = event.code,\n          keyCode = event.keyCode;\n        this.channel.emit(PREVIEW_KEYDOWN, {\n          event: {\n            altKey: altKey,\n            ctrlKey: ctrlKey,\n            metaKey: metaKey,\n            shiftKey: shiftKey,\n            key: key,\n            code: code,\n            keyCode: keyCode\n          }\n        });\n      }\n    }\n  }, {\n    key: \"onSetCurrentStory\",\n    value: function onSetCurrentStory(selection) {\n      this.urlStore.setSelection(Object.assign({\n        viewMode: 'story'\n      }, selection));\n      this.channel.emit(CURRENT_STORY_WAS_SET, this.urlStore.selection);\n      this.renderSelection();\n    }\n  }, {\n    key: \"onUpdateQueryParams\",\n    value: function onUpdateQueryParams(queryParams) {\n      this.urlStore.setQueryParams(queryParams);\n    }\n  }, {\n    key: \"onUpdateGlobals\",\n    value: function () {\n      var _onUpdateGlobals = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(_ref4) {\n        var globals;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                globals = _ref4.globals;\n                _get(_getPrototypeOf(PreviewWeb.prototype), \"onUpdateGlobals\", this).call(this, {\n                  globals: globals\n                });\n                if (!(this.currentRender instanceof DocsRender)) {\n                  _context5.next = 5;\n                  break;\n                }\n                _context5.next = 5;\n                return this.currentRender.rerender(true);\n              case 5:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n      function onUpdateGlobals(_x3) {\n        return _onUpdateGlobals.apply(this, arguments);\n      }\n      return onUpdateGlobals;\n    }()\n  }, {\n    key: \"onUpdateArgs\",\n    value: function () {\n      var _onUpdateArgs = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(_ref5) {\n        var storyId, updatedArgs;\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                storyId = _ref5.storyId, updatedArgs = _ref5.updatedArgs;\n                _get(_getPrototypeOf(PreviewWeb.prototype), \"onUpdateArgs\", this).call(this, {\n                  storyId: storyId,\n                  updatedArgs: updatedArgs\n                }); // NOTE: we aren't checking to see the story args are targetted at the \"right\" story.\n                // This is because we may render >1 story on the page and there is no easy way to keep track\n                // of which ones were rendered by the docs page.\n                // However, in `modernInlineRender`, the individual stories track their own events as they\n                // each call `renderStoryToElement` below.\n\n                if (!(this.currentRender instanceof DocsRender)) {\n                  _context6.next = 5;\n                  break;\n                }\n                _context6.next = 5;\n                return this.currentRender.rerender(false);\n              case 5:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n      function onUpdateArgs(_x4) {\n        return _onUpdateArgs.apply(this, arguments);\n      }\n      return onUpdateArgs;\n    }()\n  }, {\n    key: \"onPreloadStories\",\n    value: function () {\n      var _onPreloadStories = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(ids) {\n        var _this4 = this;\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                _context7.next = 2;\n                return Promise.all(ids.map(function (id) {\n                  return _this4.storyStore.loadStory({\n                    storyId: id\n                  });\n                }));\n              case 2:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7);\n      }));\n      function onPreloadStories(_x5) {\n        return _onPreloadStories.apply(this, arguments);\n      }\n      return onPreloadStories;\n    }() // RENDERING\n    // We can either have:\n    // - a story selected in \"story\" viewMode,\n    //     in which case we render it to the root element, OR\n    // - a story selected in \"docs\" viewMode,\n    //     in which case we render the docsPage for that story\n  }, {\n    key: \"renderSelection\",\n    value: function () {\n      var _renderSelection = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8() {\n        var _this$currentSelectio,\n          _this$currentSelectio2,\n          _lastRender,\n          _this5 = this,\n          _global$FEATURES3;\n        var _ref6,\n          persistedArgs,\n          selection,\n          storyId,\n          storyIdChanged,\n          viewModeChanged,\n          lastSelection,\n          lastRender,\n          storyRender,\n          implementationChanged,\n          _storyRender$context,\n          parameters,\n          initialArgs,\n          argTypes,\n          args,\n          _args8 = arguments;\n        return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                _ref6 = _args8.length > 0 && _args8[0] !== undefined ? _args8[0] : {}, persistedArgs = _ref6.persistedArgs;\n                selection = this.urlStore.selection;\n                if (selection) {\n                  _context8.next = 4;\n                  break;\n                }\n                throw new Error('Cannot render story as no selection was made');\n              case 4:\n                storyId = selection.storyId;\n                storyIdChanged = ((_this$currentSelectio = this.currentSelection) === null || _this$currentSelectio === void 0 ? void 0 : _this$currentSelectio.storyId) !== storyId;\n                viewModeChanged = ((_this$currentSelectio2 = this.currentSelection) === null || _this$currentSelectio2 === void 0 ? void 0 : _this$currentSelectio2.viewMode) !== selection.viewMode; // Show a spinner while we load the next story\n\n                if (selection.viewMode === 'story') {\n                  this.view.showPreparingStory({\n                    immediate: viewModeChanged\n                  });\n                } else {\n                  this.view.showPreparingDocs();\n                }\n                lastSelection = this.currentSelection;\n                lastRender = this.currentRender; // If the last render is still preparing, let's drop it right now. Either\n                //   (a) it is a different story, which means we would drop it later, OR\n                //   (b) it is the *same* story, in which case we will resolve our own .prepare() at the\n                //       same moment anyway, and we should just \"take over\" the rendering.\n                // (We can't tell which it is yet, because it is possible that an HMR is going on and\n                //  even though the storyId is the same, the story itself is not).\n\n                if (!((_lastRender = lastRender) !== null && _lastRender !== void 0 && _lastRender.isPreparing())) {\n                  _context8.next = 14;\n                  break;\n                }\n                _context8.next = 13;\n                return this.teardownRender(lastRender);\n              case 13:\n                lastRender = null;\n              case 14:\n                storyRender = new StoryRender(this.channel, this.storyStore, function () {\n                  // At the start of renderToDOM we make the story visible (see note in WebView)\n                  _this5.view.showStoryDuringRender();\n                  return _this5.renderToDOM.apply(_this5, arguments);\n                }, this.mainStoryCallbacks(storyId), storyId, 'story'); // We need to store this right away, so if the story changes during\n                // the async `.prepare()` below, we can (potentially) cancel it\n\n                this.currentSelection = selection; // Note this may be replaced by a docsRender after preparing\n\n                this.currentRender = storyRender;\n                _context8.prev = 17;\n                _context8.next = 20;\n                return storyRender.prepare();\n              case 20:\n                _context8.next = 29;\n                break;\n              case 22:\n                _context8.prev = 22;\n                _context8.t0 = _context8[\"catch\"](17);\n                if (!(_context8.t0 !== PREPARE_ABORTED)) {\n                  _context8.next = 28;\n                  break;\n                }\n                _context8.next = 27;\n                return this.teardownRender(lastRender);\n              case 27:\n                this.renderStoryLoadingException(storyId, _context8.t0);\n              case 28:\n                return _context8.abrupt(\"return\");\n              case 29:\n                implementationChanged = !storyIdChanged && !storyRender.isEqual(lastRender);\n                if (persistedArgs) this.storyStore.args.updateFromPersisted(storyRender.story, persistedArgs);\n                _storyRender$context = storyRender.context(), parameters = _storyRender$context.parameters, initialArgs = _storyRender$context.initialArgs, argTypes = _storyRender$context.argTypes, args = _storyRender$context.args; // Don't re-render the story if nothing has changed to justify it\n\n                if (!(lastRender && !storyIdChanged && !implementationChanged && !viewModeChanged)) {\n                  _context8.next = 37;\n                  break;\n                }\n                this.currentRender = lastRender;\n                this.channel.emit(STORY_UNCHANGED, storyId);\n                this.view.showMain();\n                return _context8.abrupt(\"return\");\n              case 37:\n                _context8.next = 39;\n                return this.teardownRender(lastRender, {\n                  viewModeChanged: viewModeChanged\n                });\n              case 39:\n                // If we are rendering something new (as opposed to re-rendering the same or first story), emit\n                if (lastSelection && (storyIdChanged || viewModeChanged)) {\n                  this.channel.emit(STORY_CHANGED, storyId);\n                }\n                if ((_global$FEATURES3 = global.FEATURES) !== null && _global$FEATURES3 !== void 0 && _global$FEATURES3.storyStoreV7) {\n                  this.channel.emit(STORY_PREPARED, {\n                    id: storyId,\n                    parameters: parameters,\n                    initialArgs: initialArgs,\n                    argTypes: argTypes,\n                    args: args\n                  });\n                } // For v6 mode / compatibility\n                // If the implementation changed, or args were persisted, the args may have changed,\n                // and the STORY_PREPARED event above may not be respected.\n\n                if (implementationChanged || persistedArgs) {\n                  this.channel.emit(STORY_ARGS_UPDATED, {\n                    storyId: storyId,\n                    args: args\n                  });\n                }\n                if (selection.viewMode === 'docs' || parameters.docsOnly) {\n                  this.currentRender = DocsRender.fromStoryRender(storyRender);\n                  this.currentRender.renderToElement(this.view.prepareForDocs(), this.renderStoryToElement.bind(this));\n                } else {\n                  this.storyRenders.push(storyRender);\n                  this.currentRender.renderToElement(this.view.prepareForStory(storyRender.story));\n                }\n              case 43:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this, [[17, 22]]);\n      }));\n      function renderSelection() {\n        return _renderSelection.apply(this, arguments);\n      }\n      return renderSelection;\n    }() // Used by docs' modernInlineRender to render a story to a given element\n    // Note this short-circuits the `prepare()` phase of the StoryRender,\n    // main to be consistent with the previous behaviour. In the future,\n    // we will change it to go ahead and load the story, which will end up being\n    // \"instant\", although async.\n  }, {\n    key: \"renderStoryToElement\",\n    value: function renderStoryToElement(story, element) {\n      var _this6 = this;\n      var render = new StoryRender(this.channel, this.storyStore, this.renderToDOM, this.inlineStoryCallbacks(story.id), story.id, 'docs', story);\n      render.renderToElement(element);\n      this.storyRenders.push(render);\n      return /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9() {\n        return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                _context9.next = 2;\n                return _this6.teardownRender(render);\n              case 2:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9);\n      }));\n    }\n  }, {\n    key: \"teardownRender\",\n    value: function () {\n      var _teardownRender = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee10(render) {\n        var _ref8,\n          viewModeChanged,\n          _args10 = arguments;\n        return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                _ref8 = _args10.length > 1 && _args10[1] !== undefined ? _args10[1] : {}, viewModeChanged = _ref8.viewModeChanged;\n                this.storyRenders = this.storyRenders.filter(function (r) {\n                  return r !== render;\n                });\n                _context10.next = 4;\n                return render === null || render === void 0 ? void 0 : render.teardown({\n                  viewModeChanged: viewModeChanged\n                });\n              case 4:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this);\n      }));\n      function teardownRender(_x6) {\n        return _teardownRender.apply(this, arguments);\n      }\n      return teardownRender;\n    }() // API\n  }, {\n    key: \"extract\",\n    value: function () {\n      var _extract = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee11(options) {\n        var _global$FEATURES4;\n        return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                if (!this.previewEntryError) {\n                  _context11.next = 2;\n                  break;\n                }\n                throw this.previewEntryError;\n              case 2:\n                if (this.storyStore.projectAnnotations) {\n                  _context11.next = 4;\n                  break;\n                }\n                throw new Error(dedent(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"Failed to initialize Storybook.\\n      \\n      Do you have an error in your `preview.js`? Check your Storybook's browser console for errors.\"], [\"Failed to initialize Storybook.\\n      \\n      Do you have an error in your \\\\`preview.js\\\\`? Check your Storybook's browser console for errors.\"]))));\n              case 4:\n                if (!((_global$FEATURES4 = global.FEATURES) !== null && _global$FEATURES4 !== void 0 && _global$FEATURES4.storyStoreV7)) {\n                  _context11.next = 7;\n                  break;\n                }\n                _context11.next = 7;\n                return this.storyStore.cacheAllCSFFiles();\n              case 7:\n                return _context11.abrupt(\"return\", this.storyStore.extract(options));\n              case 8:\n              case \"end\":\n                return _context11.stop();\n            }\n          }\n        }, _callee11, this);\n      }));\n      function extract(_x7) {\n        return _extract.apply(this, arguments);\n      }\n      return extract;\n    }() // UTILITIES\n  }, {\n    key: \"mainStoryCallbacks\",\n    value: function mainStoryCallbacks(storyId) {\n      var _this7 = this;\n      return {\n        showMain: function showMain() {\n          return _this7.view.showMain();\n        },\n        showError: function showError(err) {\n          return _this7.renderError(storyId, err);\n        },\n        showException: function showException(err) {\n          return _this7.renderException(storyId, err);\n        }\n      };\n    }\n  }, {\n    key: \"inlineStoryCallbacks\",\n    value: function inlineStoryCallbacks(storyId) {\n      return {\n        showMain: function showMain() {},\n        showError: function showError(err) {\n          return logger.error(\"Error rendering docs story (\".concat(storyId, \")\"), err);\n        },\n        showException: function showException(err) {\n          return logger.error(\"Error rendering docs story (\".concat(storyId, \")\"), err);\n        }\n      };\n    }\n  }, {\n    key: \"renderPreviewEntryError\",\n    value: function renderPreviewEntryError(reason, err) {\n      _get(_getPrototypeOf(PreviewWeb.prototype), \"renderPreviewEntryError\", this).call(this, reason, err);\n      this.view.showErrorDisplay(err);\n    }\n  }, {\n    key: \"renderMissingStory\",\n    value: function renderMissingStory() {\n      this.view.showNoPreview();\n      this.channel.emit(STORY_MISSING);\n    }\n  }, {\n    key: \"renderStoryLoadingException\",\n    value: function renderStoryLoadingException(storySpecifier, err) {\n      logger.error(\"Unable to load story '\".concat(storySpecifier, \"':\"));\n      logger.error(err);\n      this.view.showErrorDisplay(err);\n      this.channel.emit(STORY_MISSING, storySpecifier);\n    } // renderException is used if we fail to render the story and it is uncaught by the app layer\n  }, {\n    key: \"renderException\",\n    value: function renderException(storyId, err) {\n      this.channel.emit(STORY_THREW_EXCEPTION, err);\n      this.channel.emit(STORY_RENDER_PHASE_CHANGED, {\n        newPhase: 'errored',\n        storyId: storyId\n      }); // Ignored exceptions exist for control flow purposes, and are typically handled elsewhere.\n\n      if (err !== IGNORED_EXCEPTION) {\n        this.view.showErrorDisplay(err);\n        logger.error(\"Error rendering story '\".concat(storyId, \"':\"));\n        logger.error(err);\n      }\n    } // renderError is used by the various app layers to inform the user they have done something\n    // wrong -- for instance returned the wrong thing from a story\n  }, {\n    key: \"renderError\",\n    value: function renderError(storyId, _ref9) {\n      var title = _ref9.title,\n        description = _ref9.description;\n      logger.error(\"Error rendering story \".concat(title, \": \").concat(description));\n      this.channel.emit(STORY_ERRORED, {\n        title: title,\n        description: description\n      });\n      this.channel.emit(STORY_RENDER_PHASE_CHANGED, {\n        newPhase: 'errored',\n        storyId: storyId\n      });\n      this.view.showErrorDisplay({\n        message: title,\n        stack: description\n      });\n    }\n  }]);\n  return PreviewWeb;\n}(Preview);","map":{"version":3,"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_templateObject","_templateObject2","_templateObject3","_templateObject4","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","args","arguments","apply","err","undefined","_taggedTemplateLiteral","strings","raw","slice","Object","freeze","defineProperties","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","defineProperty","_createClass","protoProps","staticProps","_get","Reflect","get","property","receiver","base","_superPropBase","desc","getOwnPropertyDescriptor","call","object","hasOwnProperty","_getPrototypeOf","_inherits","subClass","superClass","create","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","construct","_possibleConstructorReturn","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","deprecate","dedent","global","CURRENT_STORY_WAS_SET","IGNORED_EXCEPTION","PRELOAD_STORIES","PREVIEW_KEYDOWN","SET_CURRENT_STORY","SET_STORIES","STORY_ARGS_UPDATED","STORY_CHANGED","STORY_ERRORED","STORY_MISSING","STORY_PREPARED","STORY_RENDER_PHASE_CHANGED","STORY_SPECIFIED","STORY_THREW_EXCEPTION","STORY_UNCHANGED","UPDATE_QUERY_PARAMS","logger","Preview","UrlStore","WebView","PREPARE_ABORTED","StoryRender","DocsRender","globalWindow","window","focusInInput","event","test","tagName","getAttribute","PreviewWeb","_Preview","_super","_this","urlStore","webview","view","previewEntryError","currentSelection","currentRender","storyStore","getSelection","selection","setupListeners","onkeydown","onKeydown","bind","channel","on","onSetCurrentStory","onUpdateQueryParams","onPreloadStories","initializeWithProjectAnnotations","projectAnnotations","_this2","setInitialGlobals","_setInitialGlobals","_regeneratorRuntime","mark","_callee","_ref","globals","wrap","_callee$","_context","prev","next","selectionSpecifier","updateFromPersisted","emitGlobals","stop","initializeWithStoryIndex","storyIndex","_this3","_global$FEATURES","FEATURES","storyStoreV7","emit","getSetStoriesPayload","selectSpecifiedStory","_selectSpecifiedStory","_callee2","_this$urlStore$select","storySpecifier","viewMode","storyId","_callee2$","_context2","renderMissingStory","abrupt","storyIdFromSpecifier","renderStoryLoadingException","Error","setSelection","renderSelection","persistedArgs","_onGetProjectAnnotationsChanged","_callee3","_ref2","getProjectAnnotations","_callee3$","_context3","onGetProjectAnnotationsChanged","_x","_onStoriesChanged","_callee4","_ref3","_global$FEATURES2","importFn","_callee4$","_context4","t0","t1","t2","sent","onStoriesChanged","_x2","_this$currentRender","disableKeyListeners","altKey","ctrlKey","metaKey","shiftKey","code","keyCode","assign","queryParams","setQueryParams","_onUpdateGlobals","_callee5","_ref4","_callee5$","_context5","rerender","onUpdateGlobals","_x3","_onUpdateArgs","_callee6","_ref5","updatedArgs","_callee6$","_context6","onUpdateArgs","_x4","_onPreloadStories","_callee7","ids","_this4","_callee7$","_context7","all","map","id","loadStory","_x5","_renderSelection","_callee8","_this$currentSelectio","_this$currentSelectio2","_lastRender","_this5","_global$FEATURES3","_ref6","storyIdChanged","viewModeChanged","lastSelection","lastRender","storyRender","implementationChanged","_storyRender$context","parameters","initialArgs","argTypes","_args8","_callee8$","_context8","showPreparingStory","immediate","showPreparingDocs","isPreparing","teardownRender","showStoryDuringRender","renderToDOM","mainStoryCallbacks","prepare","isEqual","story","context","showMain","docsOnly","fromStoryRender","renderToElement","prepareForDocs","renderStoryToElement","storyRenders","push","prepareForStory","element","_this6","render","inlineStoryCallbacks","_callee9","_callee9$","_context9","_teardownRender","_callee10","_ref8","_args10","_callee10$","_context10","filter","r","teardown","_x6","_extract","_callee11","options","_global$FEATURES4","_callee11$","_context11","cacheAllCSFFiles","extract","_x7","_this7","showError","renderError","showException","renderException","concat","renderPreviewEntryError","reason","showErrorDisplay","showNoPreview","newPhase","_ref9","title","description","message","stack"],"sources":["/Users/michael.restrepo/code/personal/web-components/rimuru/node_modules/@storybook/preview-web/dist/esm/PreviewWeb.js"],"sourcesContent":["function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\n\nimport \"core-js/modules/es.object.get-prototype-of.js\";\nimport \"core-js/modules/es.reflect.construct.js\";\nimport \"core-js/modules/es.reflect.get.js\";\nimport \"core-js/modules/es.object.get-own-property-descriptor.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.object.freeze.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\n\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4;\n\nimport \"regenerator-runtime/runtime.js\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nfunction _get() { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(arguments.length < 3 ? target : receiver); } return desc.value; }; } return _get.apply(this, arguments); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.object.assign.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.promise.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport deprecate from 'util-deprecate';\nimport dedent from 'ts-dedent';\nimport global from 'global';\nimport { CURRENT_STORY_WAS_SET, IGNORED_EXCEPTION, PRELOAD_STORIES, PREVIEW_KEYDOWN, SET_CURRENT_STORY, SET_STORIES, STORY_ARGS_UPDATED, STORY_CHANGED, STORY_ERRORED, STORY_MISSING, STORY_PREPARED, STORY_RENDER_PHASE_CHANGED, STORY_SPECIFIED, STORY_THREW_EXCEPTION, STORY_UNCHANGED, UPDATE_QUERY_PARAMS } from '@storybook/core-events';\nimport { logger } from '@storybook/client-logger';\nimport { Preview } from './Preview';\nimport { UrlStore } from './UrlStore';\nimport { WebView } from './WebView';\nimport { PREPARE_ABORTED, StoryRender } from './StoryRender';\nimport { DocsRender } from './DocsRender';\nvar globalWindow = global.window;\n\nfunction focusInInput(event) {\n  var target = event.target;\n  return /input|textarea/i.test(target.tagName) || target.getAttribute('contenteditable') !== null;\n}\n\nexport var PreviewWeb = /*#__PURE__*/function (_Preview) {\n  _inherits(PreviewWeb, _Preview);\n\n  var _super = _createSuper(PreviewWeb);\n\n  function PreviewWeb() {\n    var _this;\n\n    var urlStore = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new UrlStore();\n    var webview = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new WebView();\n\n    _classCallCheck(this, PreviewWeb);\n\n    _this = _super.call(this);\n    _this.urlStore = void 0;\n    _this.view = void 0;\n    _this.previewEntryError = void 0;\n    _this.currentSelection = void 0;\n    _this.currentRender = void 0;\n    _this.view = webview;\n    _this.urlStore = urlStore; // Add deprecated APIs for back-compat\n    // @ts-ignore\n\n    _this.storyStore.getSelection = deprecate(function () {\n      return _this.urlStore.selection;\n    }, dedent(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n        `__STORYBOOK_STORY_STORE__.getSelection()` is deprecated and will be removed in 7.0.\\n  \\n        To get the current selection, use the `useStoryContext()` hook from `@storybook/addons`.\\n      \"], [\"\\n        \\\\`__STORYBOOK_STORY_STORE__.getSelection()\\\\` is deprecated and will be removed in 7.0.\\n  \\n        To get the current selection, use the \\\\`useStoryContext()\\\\` hook from \\\\`@storybook/addons\\\\`.\\n      \"]))));\n    return _this;\n  }\n\n  _createClass(PreviewWeb, [{\n    key: \"setupListeners\",\n    value: function setupListeners() {\n      _get(_getPrototypeOf(PreviewWeb.prototype), \"setupListeners\", this).call(this);\n\n      globalWindow.onkeydown = this.onKeydown.bind(this);\n      this.channel.on(SET_CURRENT_STORY, this.onSetCurrentStory.bind(this));\n      this.channel.on(UPDATE_QUERY_PARAMS, this.onUpdateQueryParams.bind(this));\n      this.channel.on(PRELOAD_STORIES, this.onPreloadStories.bind(this));\n    }\n  }, {\n    key: \"initializeWithProjectAnnotations\",\n    value: function initializeWithProjectAnnotations(projectAnnotations) {\n      var _this2 = this;\n\n      return _get(_getPrototypeOf(PreviewWeb.prototype), \"initializeWithProjectAnnotations\", this).call(this, projectAnnotations).then(function () {\n        return _this2.setInitialGlobals();\n      });\n    }\n  }, {\n    key: \"setInitialGlobals\",\n    value: function () {\n      var _setInitialGlobals = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var _ref, globals;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _ref = this.urlStore.selectionSpecifier || {}, globals = _ref.globals;\n\n                if (globals) {\n                  this.storyStore.globals.updateFromPersisted(globals);\n                }\n\n                this.emitGlobals();\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function setInitialGlobals() {\n        return _setInitialGlobals.apply(this, arguments);\n      }\n\n      return setInitialGlobals;\n    }() // If initialization gets as far as the story index, this function runs.\n\n  }, {\n    key: \"initializeWithStoryIndex\",\n    value: function initializeWithStoryIndex(storyIndex) {\n      var _this3 = this;\n\n      return _get(_getPrototypeOf(PreviewWeb.prototype), \"initializeWithStoryIndex\", this).call(this, storyIndex).then(function () {\n        var _global$FEATURES;\n\n        if (!((_global$FEATURES = global.FEATURES) !== null && _global$FEATURES !== void 0 && _global$FEATURES.storyStoreV7)) {\n          _this3.channel.emit(SET_STORIES, _this3.storyStore.getSetStoriesPayload());\n        }\n\n        return _this3.selectSpecifiedStory();\n      });\n    } // Use the selection specifier to choose a story, then render it\n\n  }, {\n    key: \"selectSpecifiedStory\",\n    value: function () {\n      var _selectSpecifiedStory = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        var _this$urlStore$select, storySpecifier, viewMode, args, storyId;\n\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (this.urlStore.selectionSpecifier) {\n                  _context2.next = 3;\n                  break;\n                }\n\n                this.renderMissingStory();\n                return _context2.abrupt(\"return\");\n\n              case 3:\n                _this$urlStore$select = this.urlStore.selectionSpecifier, storySpecifier = _this$urlStore$select.storySpecifier, viewMode = _this$urlStore$select.viewMode, args = _this$urlStore$select.args;\n                storyId = this.storyStore.storyIndex.storyIdFromSpecifier(storySpecifier);\n\n                if (storyId) {\n                  _context2.next = 8;\n                  break;\n                }\n\n                if (storySpecifier === '*') {\n                  this.renderStoryLoadingException(storySpecifier, new Error(dedent(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\n            Couldn't find any stories in your Storybook.\\n            - Please check your stories field of your main.js config.\\n            - Also check the browser console and terminal for error messages.\\n          \"])))));\n                } else {\n                  this.renderStoryLoadingException(storySpecifier, new Error(dedent(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\\n            Couldn't find story matching '\", \"'.\\n            - Are you sure a story with that id exists?\\n            - Please check your stories field of your main.js config.\\n            - Also check the browser console and terminal for error messages.\\n          \"])), storySpecifier)));\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 8:\n                this.urlStore.setSelection({\n                  storyId: storyId,\n                  viewMode: viewMode\n                });\n                this.channel.emit(STORY_SPECIFIED, this.urlStore.selection);\n                this.channel.emit(CURRENT_STORY_WAS_SET, this.urlStore.selection);\n                _context2.next = 13;\n                return this.renderSelection({\n                  persistedArgs: args\n                });\n\n              case 13:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function selectSpecifiedStory() {\n        return _selectSpecifiedStory.apply(this, arguments);\n      }\n\n      return selectSpecifiedStory;\n    }() // EVENT HANDLERS\n    // This happens when a config file gets reloaded\n\n  }, {\n    key: \"onGetProjectAnnotationsChanged\",\n    value: function () {\n      var _onGetProjectAnnotationsChanged = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(_ref2) {\n        var getProjectAnnotations;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                getProjectAnnotations = _ref2.getProjectAnnotations;\n                _context3.next = 3;\n                return _get(_getPrototypeOf(PreviewWeb.prototype), \"onGetProjectAnnotationsChanged\", this).call(this, {\n                  getProjectAnnotations: getProjectAnnotations\n                });\n\n              case 3:\n                this.renderSelection();\n\n              case 4:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function onGetProjectAnnotationsChanged(_x) {\n        return _onGetProjectAnnotationsChanged.apply(this, arguments);\n      }\n\n      return onGetProjectAnnotationsChanged;\n    }() // This happens when a glob gets HMR-ed\n\n  }, {\n    key: \"onStoriesChanged\",\n    value: function () {\n      var _onStoriesChanged = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(_ref3) {\n        var _global$FEATURES2;\n\n        var importFn, storyIndex;\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                importFn = _ref3.importFn, storyIndex = _ref3.storyIndex;\n\n                _get(_getPrototypeOf(PreviewWeb.prototype), \"onStoriesChanged\", this).call(this, {\n                  importFn: importFn,\n                  storyIndex: storyIndex\n                });\n\n                if ((_global$FEATURES2 = global.FEATURES) !== null && _global$FEATURES2 !== void 0 && _global$FEATURES2.storyStoreV7) {\n                  _context4.next = 9;\n                  break;\n                }\n\n                _context4.t0 = this.channel;\n                _context4.t1 = SET_STORIES;\n                _context4.next = 7;\n                return this.storyStore.getSetStoriesPayload();\n\n              case 7:\n                _context4.t2 = _context4.sent;\n\n                _context4.t0.emit.call(_context4.t0, _context4.t1, _context4.t2);\n\n              case 9:\n                if (!this.urlStore.selection) {\n                  _context4.next = 14;\n                  break;\n                }\n\n                _context4.next = 12;\n                return this.renderSelection();\n\n              case 12:\n                _context4.next = 16;\n                break;\n\n              case 14:\n                _context4.next = 16;\n                return this.selectSpecifiedStory();\n\n              case 16:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function onStoriesChanged(_x2) {\n        return _onStoriesChanged.apply(this, arguments);\n      }\n\n      return onStoriesChanged;\n    }()\n  }, {\n    key: \"onKeydown\",\n    value: function onKeydown(event) {\n      var _this$currentRender;\n\n      if (!((_this$currentRender = this.currentRender) !== null && _this$currentRender !== void 0 && _this$currentRender.disableKeyListeners) && !focusInInput(event)) {\n        // We have to pick off the keys of the event that we need on the other side\n        var altKey = event.altKey,\n            ctrlKey = event.ctrlKey,\n            metaKey = event.metaKey,\n            shiftKey = event.shiftKey,\n            key = event.key,\n            code = event.code,\n            keyCode = event.keyCode;\n        this.channel.emit(PREVIEW_KEYDOWN, {\n          event: {\n            altKey: altKey,\n            ctrlKey: ctrlKey,\n            metaKey: metaKey,\n            shiftKey: shiftKey,\n            key: key,\n            code: code,\n            keyCode: keyCode\n          }\n        });\n      }\n    }\n  }, {\n    key: \"onSetCurrentStory\",\n    value: function onSetCurrentStory(selection) {\n      this.urlStore.setSelection(Object.assign({\n        viewMode: 'story'\n      }, selection));\n      this.channel.emit(CURRENT_STORY_WAS_SET, this.urlStore.selection);\n      this.renderSelection();\n    }\n  }, {\n    key: \"onUpdateQueryParams\",\n    value: function onUpdateQueryParams(queryParams) {\n      this.urlStore.setQueryParams(queryParams);\n    }\n  }, {\n    key: \"onUpdateGlobals\",\n    value: function () {\n      var _onUpdateGlobals = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5(_ref4) {\n        var globals;\n        return regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                globals = _ref4.globals;\n\n                _get(_getPrototypeOf(PreviewWeb.prototype), \"onUpdateGlobals\", this).call(this, {\n                  globals: globals\n                });\n\n                if (!(this.currentRender instanceof DocsRender)) {\n                  _context5.next = 5;\n                  break;\n                }\n\n                _context5.next = 5;\n                return this.currentRender.rerender(true);\n\n              case 5:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function onUpdateGlobals(_x3) {\n        return _onUpdateGlobals.apply(this, arguments);\n      }\n\n      return onUpdateGlobals;\n    }()\n  }, {\n    key: \"onUpdateArgs\",\n    value: function () {\n      var _onUpdateArgs = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6(_ref5) {\n        var storyId, updatedArgs;\n        return regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                storyId = _ref5.storyId, updatedArgs = _ref5.updatedArgs;\n\n                _get(_getPrototypeOf(PreviewWeb.prototype), \"onUpdateArgs\", this).call(this, {\n                  storyId: storyId,\n                  updatedArgs: updatedArgs\n                }); // NOTE: we aren't checking to see the story args are targetted at the \"right\" story.\n                // This is because we may render >1 story on the page and there is no easy way to keep track\n                // of which ones were rendered by the docs page.\n                // However, in `modernInlineRender`, the individual stories track their own events as they\n                // each call `renderStoryToElement` below.\n\n\n                if (!(this.currentRender instanceof DocsRender)) {\n                  _context6.next = 5;\n                  break;\n                }\n\n                _context6.next = 5;\n                return this.currentRender.rerender(false);\n\n              case 5:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function onUpdateArgs(_x4) {\n        return _onUpdateArgs.apply(this, arguments);\n      }\n\n      return onUpdateArgs;\n    }()\n  }, {\n    key: \"onPreloadStories\",\n    value: function () {\n      var _onPreloadStories = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee7(ids) {\n        var _this4 = this;\n\n        return regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                _context7.next = 2;\n                return Promise.all(ids.map(function (id) {\n                  return _this4.storyStore.loadStory({\n                    storyId: id\n                  });\n                }));\n\n              case 2:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7);\n      }));\n\n      function onPreloadStories(_x5) {\n        return _onPreloadStories.apply(this, arguments);\n      }\n\n      return onPreloadStories;\n    }() // RENDERING\n    // We can either have:\n    // - a story selected in \"story\" viewMode,\n    //     in which case we render it to the root element, OR\n    // - a story selected in \"docs\" viewMode,\n    //     in which case we render the docsPage for that story\n\n  }, {\n    key: \"renderSelection\",\n    value: function () {\n      var _renderSelection = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee8() {\n        var _this$currentSelectio,\n            _this$currentSelectio2,\n            _lastRender,\n            _this5 = this,\n            _global$FEATURES3;\n\n        var _ref6,\n            persistedArgs,\n            selection,\n            storyId,\n            storyIdChanged,\n            viewModeChanged,\n            lastSelection,\n            lastRender,\n            storyRender,\n            implementationChanged,\n            _storyRender$context,\n            parameters,\n            initialArgs,\n            argTypes,\n            args,\n            _args8 = arguments;\n\n        return regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                _ref6 = _args8.length > 0 && _args8[0] !== undefined ? _args8[0] : {}, persistedArgs = _ref6.persistedArgs;\n                selection = this.urlStore.selection;\n\n                if (selection) {\n                  _context8.next = 4;\n                  break;\n                }\n\n                throw new Error('Cannot render story as no selection was made');\n\n              case 4:\n                storyId = selection.storyId;\n                storyIdChanged = ((_this$currentSelectio = this.currentSelection) === null || _this$currentSelectio === void 0 ? void 0 : _this$currentSelectio.storyId) !== storyId;\n                viewModeChanged = ((_this$currentSelectio2 = this.currentSelection) === null || _this$currentSelectio2 === void 0 ? void 0 : _this$currentSelectio2.viewMode) !== selection.viewMode; // Show a spinner while we load the next story\n\n                if (selection.viewMode === 'story') {\n                  this.view.showPreparingStory({\n                    immediate: viewModeChanged\n                  });\n                } else {\n                  this.view.showPreparingDocs();\n                }\n\n                lastSelection = this.currentSelection;\n                lastRender = this.currentRender; // If the last render is still preparing, let's drop it right now. Either\n                //   (a) it is a different story, which means we would drop it later, OR\n                //   (b) it is the *same* story, in which case we will resolve our own .prepare() at the\n                //       same moment anyway, and we should just \"take over\" the rendering.\n                // (We can't tell which it is yet, because it is possible that an HMR is going on and\n                //  even though the storyId is the same, the story itself is not).\n\n                if (!((_lastRender = lastRender) !== null && _lastRender !== void 0 && _lastRender.isPreparing())) {\n                  _context8.next = 14;\n                  break;\n                }\n\n                _context8.next = 13;\n                return this.teardownRender(lastRender);\n\n              case 13:\n                lastRender = null;\n\n              case 14:\n                storyRender = new StoryRender(this.channel, this.storyStore, function () {\n                  // At the start of renderToDOM we make the story visible (see note in WebView)\n                  _this5.view.showStoryDuringRender();\n\n                  return _this5.renderToDOM.apply(_this5, arguments);\n                }, this.mainStoryCallbacks(storyId), storyId, 'story'); // We need to store this right away, so if the story changes during\n                // the async `.prepare()` below, we can (potentially) cancel it\n\n                this.currentSelection = selection; // Note this may be replaced by a docsRender after preparing\n\n                this.currentRender = storyRender;\n                _context8.prev = 17;\n                _context8.next = 20;\n                return storyRender.prepare();\n\n              case 20:\n                _context8.next = 29;\n                break;\n\n              case 22:\n                _context8.prev = 22;\n                _context8.t0 = _context8[\"catch\"](17);\n\n                if (!(_context8.t0 !== PREPARE_ABORTED)) {\n                  _context8.next = 28;\n                  break;\n                }\n\n                _context8.next = 27;\n                return this.teardownRender(lastRender);\n\n              case 27:\n                this.renderStoryLoadingException(storyId, _context8.t0);\n\n              case 28:\n                return _context8.abrupt(\"return\");\n\n              case 29:\n                implementationChanged = !storyIdChanged && !storyRender.isEqual(lastRender);\n                if (persistedArgs) this.storyStore.args.updateFromPersisted(storyRender.story, persistedArgs);\n                _storyRender$context = storyRender.context(), parameters = _storyRender$context.parameters, initialArgs = _storyRender$context.initialArgs, argTypes = _storyRender$context.argTypes, args = _storyRender$context.args; // Don't re-render the story if nothing has changed to justify it\n\n                if (!(lastRender && !storyIdChanged && !implementationChanged && !viewModeChanged)) {\n                  _context8.next = 37;\n                  break;\n                }\n\n                this.currentRender = lastRender;\n                this.channel.emit(STORY_UNCHANGED, storyId);\n                this.view.showMain();\n                return _context8.abrupt(\"return\");\n\n              case 37:\n                _context8.next = 39;\n                return this.teardownRender(lastRender, {\n                  viewModeChanged: viewModeChanged\n                });\n\n              case 39:\n                // If we are rendering something new (as opposed to re-rendering the same or first story), emit\n                if (lastSelection && (storyIdChanged || viewModeChanged)) {\n                  this.channel.emit(STORY_CHANGED, storyId);\n                }\n\n                if ((_global$FEATURES3 = global.FEATURES) !== null && _global$FEATURES3 !== void 0 && _global$FEATURES3.storyStoreV7) {\n                  this.channel.emit(STORY_PREPARED, {\n                    id: storyId,\n                    parameters: parameters,\n                    initialArgs: initialArgs,\n                    argTypes: argTypes,\n                    args: args\n                  });\n                } // For v6 mode / compatibility\n                // If the implementation changed, or args were persisted, the args may have changed,\n                // and the STORY_PREPARED event above may not be respected.\n\n\n                if (implementationChanged || persistedArgs) {\n                  this.channel.emit(STORY_ARGS_UPDATED, {\n                    storyId: storyId,\n                    args: args\n                  });\n                }\n\n                if (selection.viewMode === 'docs' || parameters.docsOnly) {\n                  this.currentRender = DocsRender.fromStoryRender(storyRender);\n                  this.currentRender.renderToElement(this.view.prepareForDocs(), this.renderStoryToElement.bind(this));\n                } else {\n                  this.storyRenders.push(storyRender);\n                  this.currentRender.renderToElement(this.view.prepareForStory(storyRender.story));\n                }\n\n              case 43:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this, [[17, 22]]);\n      }));\n\n      function renderSelection() {\n        return _renderSelection.apply(this, arguments);\n      }\n\n      return renderSelection;\n    }() // Used by docs' modernInlineRender to render a story to a given element\n    // Note this short-circuits the `prepare()` phase of the StoryRender,\n    // main to be consistent with the previous behaviour. In the future,\n    // we will change it to go ahead and load the story, which will end up being\n    // \"instant\", although async.\n\n  }, {\n    key: \"renderStoryToElement\",\n    value: function renderStoryToElement(story, element) {\n      var _this6 = this;\n\n      var render = new StoryRender(this.channel, this.storyStore, this.renderToDOM, this.inlineStoryCallbacks(story.id), story.id, 'docs', story);\n      render.renderToElement(element);\n      this.storyRenders.push(render);\n      return /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee9() {\n        return regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                _context9.next = 2;\n                return _this6.teardownRender(render);\n\n              case 2:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9);\n      }));\n    }\n  }, {\n    key: \"teardownRender\",\n    value: function () {\n      var _teardownRender = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee10(render) {\n        var _ref8,\n            viewModeChanged,\n            _args10 = arguments;\n\n        return regeneratorRuntime.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                _ref8 = _args10.length > 1 && _args10[1] !== undefined ? _args10[1] : {}, viewModeChanged = _ref8.viewModeChanged;\n                this.storyRenders = this.storyRenders.filter(function (r) {\n                  return r !== render;\n                });\n                _context10.next = 4;\n                return render === null || render === void 0 ? void 0 : render.teardown({\n                  viewModeChanged: viewModeChanged\n                });\n\n              case 4:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this);\n      }));\n\n      function teardownRender(_x6) {\n        return _teardownRender.apply(this, arguments);\n      }\n\n      return teardownRender;\n    }() // API\n\n  }, {\n    key: \"extract\",\n    value: function () {\n      var _extract = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee11(options) {\n        var _global$FEATURES4;\n\n        return regeneratorRuntime.wrap(function _callee11$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                if (!this.previewEntryError) {\n                  _context11.next = 2;\n                  break;\n                }\n\n                throw this.previewEntryError;\n\n              case 2:\n                if (this.storyStore.projectAnnotations) {\n                  _context11.next = 4;\n                  break;\n                }\n\n                throw new Error(dedent(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"Failed to initialize Storybook.\\n      \\n      Do you have an error in your `preview.js`? Check your Storybook's browser console for errors.\"], [\"Failed to initialize Storybook.\\n      \\n      Do you have an error in your \\\\`preview.js\\\\`? Check your Storybook's browser console for errors.\"]))));\n\n              case 4:\n                if (!((_global$FEATURES4 = global.FEATURES) !== null && _global$FEATURES4 !== void 0 && _global$FEATURES4.storyStoreV7)) {\n                  _context11.next = 7;\n                  break;\n                }\n\n                _context11.next = 7;\n                return this.storyStore.cacheAllCSFFiles();\n\n              case 7:\n                return _context11.abrupt(\"return\", this.storyStore.extract(options));\n\n              case 8:\n              case \"end\":\n                return _context11.stop();\n            }\n          }\n        }, _callee11, this);\n      }));\n\n      function extract(_x7) {\n        return _extract.apply(this, arguments);\n      }\n\n      return extract;\n    }() // UTILITIES\n\n  }, {\n    key: \"mainStoryCallbacks\",\n    value: function mainStoryCallbacks(storyId) {\n      var _this7 = this;\n\n      return {\n        showMain: function showMain() {\n          return _this7.view.showMain();\n        },\n        showError: function showError(err) {\n          return _this7.renderError(storyId, err);\n        },\n        showException: function showException(err) {\n          return _this7.renderException(storyId, err);\n        }\n      };\n    }\n  }, {\n    key: \"inlineStoryCallbacks\",\n    value: function inlineStoryCallbacks(storyId) {\n      return {\n        showMain: function showMain() {},\n        showError: function showError(err) {\n          return logger.error(\"Error rendering docs story (\".concat(storyId, \")\"), err);\n        },\n        showException: function showException(err) {\n          return logger.error(\"Error rendering docs story (\".concat(storyId, \")\"), err);\n        }\n      };\n    }\n  }, {\n    key: \"renderPreviewEntryError\",\n    value: function renderPreviewEntryError(reason, err) {\n      _get(_getPrototypeOf(PreviewWeb.prototype), \"renderPreviewEntryError\", this).call(this, reason, err);\n\n      this.view.showErrorDisplay(err);\n    }\n  }, {\n    key: \"renderMissingStory\",\n    value: function renderMissingStory() {\n      this.view.showNoPreview();\n      this.channel.emit(STORY_MISSING);\n    }\n  }, {\n    key: \"renderStoryLoadingException\",\n    value: function renderStoryLoadingException(storySpecifier, err) {\n      logger.error(\"Unable to load story '\".concat(storySpecifier, \"':\"));\n      logger.error(err);\n      this.view.showErrorDisplay(err);\n      this.channel.emit(STORY_MISSING, storySpecifier);\n    } // renderException is used if we fail to render the story and it is uncaught by the app layer\n\n  }, {\n    key: \"renderException\",\n    value: function renderException(storyId, err) {\n      this.channel.emit(STORY_THREW_EXCEPTION, err);\n      this.channel.emit(STORY_RENDER_PHASE_CHANGED, {\n        newPhase: 'errored',\n        storyId: storyId\n      }); // Ignored exceptions exist for control flow purposes, and are typically handled elsewhere.\n\n      if (err !== IGNORED_EXCEPTION) {\n        this.view.showErrorDisplay(err);\n        logger.error(\"Error rendering story '\".concat(storyId, \"':\"));\n        logger.error(err);\n      }\n    } // renderError is used by the various app layers to inform the user they have done something\n    // wrong -- for instance returned the wrong thing from a story\n\n  }, {\n    key: \"renderError\",\n    value: function renderError(storyId, _ref9) {\n      var title = _ref9.title,\n          description = _ref9.description;\n      logger.error(\"Error rendering story \".concat(title, \": \").concat(description));\n      this.channel.emit(STORY_ERRORED, {\n        title: title,\n        description: description\n      });\n      this.channel.emit(STORY_RENDER_PHASE_CHANGED, {\n        newPhase: 'errored',\n        storyId: storyId\n      });\n      this.view.showErrorDisplay({\n        message: title,\n        stack: description\n      });\n    }\n  }]);\n\n  return PreviewWeb;\n}(Preview);"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}