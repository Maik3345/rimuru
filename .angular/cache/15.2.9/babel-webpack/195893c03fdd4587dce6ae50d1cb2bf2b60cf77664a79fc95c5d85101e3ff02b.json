{"ast":null,"code":"import _regeneratorRuntime from \"/Users/michael.restrepo/code/personal/web-components/rimuru/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/regenerator/index.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.object.freeze.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\nimport \"core-js/modules/es.array.from.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nvar _templateObject, _templateObject2;\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n  return arr2;\n}\nimport \"regenerator-runtime/runtime.js\";\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n      args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n      _next(undefined);\n    });\n  };\n}\nfunction _taggedTemplateLiteral(strings, raw) {\n  if (!raw) {\n    raw = strings.slice(0);\n  }\n  return Object.freeze(Object.defineProperties(strings, {\n    raw: {\n      value: Object.freeze(raw)\n    }\n  }));\n}\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.promise.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.set.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport dedent from 'ts-dedent';\nimport global from 'global';\nimport { SynchronousPromise } from 'synchronous-promise';\nimport { CONFIG_ERROR, FORCE_REMOUNT, FORCE_RE_RENDER, GLOBALS_UPDATED, RESET_STORY_ARGS, SET_GLOBALS, STORY_ARGS_UPDATED, STORY_INDEX_INVALIDATED, UPDATE_GLOBALS, UPDATE_STORY_ARGS } from '@storybook/core-events';\nimport { logger } from '@storybook/client-logger';\nimport { addons } from '@storybook/addons';\nimport { StoryStore } from '@storybook/store';\nimport { StoryRender } from './StoryRender';\nvar fetch = global.fetch;\nvar STORY_INDEX_PATH = './stories.json';\nexport var Preview = /*#__PURE__*/function () {\n  function Preview() {\n    var _global$FEATURES;\n    _classCallCheck(this, Preview);\n    this.channel = void 0;\n    this.serverChannel = void 0;\n    this.storyStore = void 0;\n    this.getStoryIndex = void 0;\n    this.importFn = void 0;\n    this.renderToDOM = void 0;\n    this.storyRenders = [];\n    this.previewEntryError = void 0;\n    this.channel = addons.getChannel();\n    if ((_global$FEATURES = global.FEATURES) !== null && _global$FEATURES !== void 0 && _global$FEATURES.storyStoreV7 && addons.hasServerChannel()) {\n      this.serverChannel = addons.getServerChannel();\n    }\n    this.storyStore = new StoryStore();\n  } // INITIALIZATION\n  // NOTE: the reason that the preview and store's initialization code is written in a promise\n  // style and not `async-await`, and the use of `SynchronousPromise`s is in order to allow\n  // storyshots to immediately call `raw()` on the store without waiting for a later tick.\n  // (Even simple things like `Promise.resolve()` and `await` involve the callback happening\n  // in the next promise \"tick\").\n  // See the comment in `storyshots-core/src/api/index.ts` for more detail.\n\n  _createClass(Preview, [{\n    key: \"initialize\",\n    value: function initialize(_ref) {\n      var _this = this;\n      var getStoryIndex = _ref.getStoryIndex,\n        importFn = _ref.importFn,\n        getProjectAnnotations = _ref.getProjectAnnotations;\n      // We save these two on initialization in case `getProjectAnnotations` errors,\n      // in which case we may need them later when we recover.\n      this.getStoryIndex = getStoryIndex;\n      this.importFn = importFn;\n      this.setupListeners();\n      return this.getProjectAnnotationsOrRenderError(getProjectAnnotations).then(function (projectAnnotations) {\n        return _this.initializeWithProjectAnnotations(projectAnnotations);\n      });\n    }\n  }, {\n    key: \"setupListeners\",\n    value: function setupListeners() {\n      var _this$serverChannel;\n      (_this$serverChannel = this.serverChannel) === null || _this$serverChannel === void 0 ? void 0 : _this$serverChannel.on(STORY_INDEX_INVALIDATED, this.onStoryIndexChanged.bind(this));\n      this.channel.on(UPDATE_GLOBALS, this.onUpdateGlobals.bind(this));\n      this.channel.on(UPDATE_STORY_ARGS, this.onUpdateArgs.bind(this));\n      this.channel.on(RESET_STORY_ARGS, this.onResetArgs.bind(this));\n      this.channel.on(FORCE_RE_RENDER, this.onForceReRender.bind(this));\n      this.channel.on(FORCE_REMOUNT, this.onForceRemount.bind(this));\n    }\n  }, {\n    key: \"getProjectAnnotationsOrRenderError\",\n    value: function getProjectAnnotationsOrRenderError(getProjectAnnotations) {\n      var _this2 = this;\n      return SynchronousPromise.resolve().then(getProjectAnnotations).then(function (projectAnnotations) {\n        _this2.renderToDOM = projectAnnotations.renderToDOM;\n        if (!_this2.renderToDOM) {\n          throw new Error(dedent(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n            Expected your framework's preset to export a `renderToDOM` field.\\n\\n            Perhaps it needs to be upgraded for Storybook 6.4?\\n\\n            More info: https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#mainjs-framework-field          \\n          \"], [\"\\n            Expected your framework's preset to export a \\\\`renderToDOM\\\\` field.\\n\\n            Perhaps it needs to be upgraded for Storybook 6.4?\\n\\n            More info: https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#mainjs-framework-field          \\n          \"]))));\n        }\n        return projectAnnotations;\n      }).catch(function (err) {\n        // This is an error extracting the projectAnnotations (i.e. evaluating the previewEntries) and\n        // needs to be show to the user as a simple error\n        _this2.renderPreviewEntryError('Error reading preview.js:', err);\n        throw err;\n      });\n    } // If initialization gets as far as project annotations, this function runs.\n  }, {\n    key: \"initializeWithProjectAnnotations\",\n    value: function initializeWithProjectAnnotations(projectAnnotations) {\n      var _global$FEATURES2,\n        _this3 = this;\n      this.storyStore.setProjectAnnotations(projectAnnotations);\n      this.setInitialGlobals();\n      var storyIndexPromise;\n      if ((_global$FEATURES2 = global.FEATURES) !== null && _global$FEATURES2 !== void 0 && _global$FEATURES2.storyStoreV7) {\n        storyIndexPromise = this.getStoryIndexFromServer();\n      } else {\n        if (!this.getStoryIndex) {\n          throw new Error('No `getStoryIndex` passed defined in v6 mode');\n        }\n        storyIndexPromise = SynchronousPromise.resolve().then(this.getStoryIndex);\n      }\n      return storyIndexPromise.then(function (storyIndex) {\n        return _this3.initializeWithStoryIndex(storyIndex);\n      }).catch(function (err) {\n        _this3.renderPreviewEntryError('Error loading story index:', err);\n        throw err;\n      });\n    }\n  }, {\n    key: \"setInitialGlobals\",\n    value: function () {\n      var _setInitialGlobals = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.emitGlobals();\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n      function setInitialGlobals() {\n        return _setInitialGlobals.apply(this, arguments);\n      }\n      return setInitialGlobals;\n    }()\n  }, {\n    key: \"emitGlobals\",\n    value: function emitGlobals() {\n      this.channel.emit(SET_GLOBALS, {\n        globals: this.storyStore.globals.get() || {},\n        globalTypes: this.storyStore.projectAnnotations.globalTypes || {}\n      });\n    }\n  }, {\n    key: \"getStoryIndexFromServer\",\n    value: function () {\n      var _getStoryIndexFromServer = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var result;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return fetch(STORY_INDEX_PATH);\n              case 2:\n                result = _context2.sent;\n                if (!(result.status === 200)) {\n                  _context2.next = 5;\n                  break;\n                }\n                return _context2.abrupt(\"return\", result.json());\n              case 5:\n                _context2.t0 = Error;\n                _context2.next = 8;\n                return result.text();\n              case 8:\n                _context2.t1 = _context2.sent;\n                throw new _context2.t0(_context2.t1);\n              case 10:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n      function getStoryIndexFromServer() {\n        return _getStoryIndexFromServer.apply(this, arguments);\n      }\n      return getStoryIndexFromServer;\n    }() // If initialization gets as far as the story index, this function runs.\n  }, {\n    key: \"initializeWithStoryIndex\",\n    value: function initializeWithStoryIndex(storyIndex) {\n      var _global$FEATURES3;\n      return this.storyStore.initialize({\n        storyIndex: storyIndex,\n        importFn: this.importFn,\n        cache: !((_global$FEATURES3 = global.FEATURES) !== null && _global$FEATURES3 !== void 0 && _global$FEATURES3.storyStoreV7)\n      });\n    } // EVENT HANDLERS\n    // This happens when a config file gets reloaded\n  }, {\n    key: \"onGetProjectAnnotationsChanged\",\n    value: function () {\n      var _onGetProjectAnnotationsChanged = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(_ref2) {\n        var getProjectAnnotations, projectAnnotations;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                getProjectAnnotations = _ref2.getProjectAnnotations;\n                delete this.previewEntryError;\n                _context3.next = 4;\n                return this.getProjectAnnotationsOrRenderError(getProjectAnnotations);\n              case 4:\n                projectAnnotations = _context3.sent;\n                if (this.storyStore.projectAnnotations) {\n                  _context3.next = 9;\n                  break;\n                }\n                _context3.next = 8;\n                return this.initializeWithProjectAnnotations(projectAnnotations);\n              case 8:\n                return _context3.abrupt(\"return\");\n              case 9:\n                _context3.next = 11;\n                return this.storyStore.setProjectAnnotations(projectAnnotations);\n              case 11:\n                this.emitGlobals();\n              case 12:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n      function onGetProjectAnnotationsChanged(_x) {\n        return _onGetProjectAnnotationsChanged.apply(this, arguments);\n      }\n      return onGetProjectAnnotationsChanged;\n    }()\n  }, {\n    key: \"onStoryIndexChanged\",\n    value: function () {\n      var _onStoryIndexChanged = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        var storyIndex;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                delete this.previewEntryError;\n                if (this.storyStore.projectAnnotations) {\n                  _context4.next = 3;\n                  break;\n                }\n                return _context4.abrupt(\"return\");\n              case 3:\n                _context4.prev = 3;\n                _context4.next = 6;\n                return this.getStoryIndexFromServer();\n              case 6:\n                storyIndex = _context4.sent;\n                if (this.storyStore.storyIndex) {\n                  _context4.next = 10;\n                  break;\n                }\n                _context4.next = 10;\n                return this.initializeWithStoryIndex(storyIndex);\n              case 10:\n                _context4.next = 12;\n                return this.onStoriesChanged({\n                  storyIndex: storyIndex\n                });\n              case 12:\n                _context4.next = 18;\n                break;\n              case 14:\n                _context4.prev = 14;\n                _context4.t0 = _context4[\"catch\"](3);\n                this.renderPreviewEntryError('Error loading story index:', _context4.t0);\n                throw _context4.t0;\n              case 18:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[3, 14]]);\n      }));\n      function onStoryIndexChanged() {\n        return _onStoryIndexChanged.apply(this, arguments);\n      }\n      return onStoryIndexChanged;\n    }() // This happens when a glob gets HMR-ed\n  }, {\n    key: \"onStoriesChanged\",\n    value: function () {\n      var _onStoriesChanged = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(_ref3) {\n        var importFn, storyIndex;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                importFn = _ref3.importFn, storyIndex = _ref3.storyIndex;\n                _context5.next = 3;\n                return this.storyStore.onStoriesChanged({\n                  importFn: importFn,\n                  storyIndex: storyIndex\n                });\n              case 3:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n      function onStoriesChanged(_x2) {\n        return _onStoriesChanged.apply(this, arguments);\n      }\n      return onStoriesChanged;\n    }()\n  }, {\n    key: \"onUpdateGlobals\",\n    value: function () {\n      var _onUpdateGlobals = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(_ref4) {\n        var globals;\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                globals = _ref4.globals;\n                this.storyStore.globals.update(globals);\n                _context6.next = 4;\n                return Promise.all(this.storyRenders.map(function (r) {\n                  return r.rerender();\n                }));\n              case 4:\n                this.channel.emit(GLOBALS_UPDATED, {\n                  globals: this.storyStore.globals.get(),\n                  initialGlobals: this.storyStore.globals.initialGlobals\n                });\n              case 5:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n      function onUpdateGlobals(_x3) {\n        return _onUpdateGlobals.apply(this, arguments);\n      }\n      return onUpdateGlobals;\n    }()\n  }, {\n    key: \"onUpdateArgs\",\n    value: function () {\n      var _onUpdateArgs = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(_ref5) {\n        var storyId, updatedArgs;\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                storyId = _ref5.storyId, updatedArgs = _ref5.updatedArgs;\n                this.storyStore.args.update(storyId, updatedArgs);\n                _context7.next = 4;\n                return Promise.all(this.storyRenders.filter(function (r) {\n                  return r.id === storyId;\n                }).map(function (r) {\n                  return r.rerender();\n                }));\n              case 4:\n                this.channel.emit(STORY_ARGS_UPDATED, {\n                  storyId: storyId,\n                  args: this.storyStore.args.get(storyId)\n                });\n              case 5:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n      function onUpdateArgs(_x4) {\n        return _onUpdateArgs.apply(this, arguments);\n      }\n      return onUpdateArgs;\n    }()\n  }, {\n    key: \"onResetArgs\",\n    value: function () {\n      var _onResetArgs = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(_ref6) {\n        var storyId, argNames, render, story, argNamesToReset, updatedArgs;\n        return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                storyId = _ref6.storyId, argNames = _ref6.argNames;\n                // NOTE: we have to be careful here and avoid await-ing when updating a rendered's args.\n                // That's because below in `renderStoryToElement` we have also bound to this event and will\n                // render the story in the same tick.\n                // However, we can do that safely as the current story is available in `this.storyRenders`\n                render = this.storyRenders.find(function (r) {\n                  return r.id === storyId;\n                });\n                _context8.t0 = render === null || render === void 0 ? void 0 : render.story;\n                if (_context8.t0) {\n                  _context8.next = 7;\n                  break;\n                }\n                _context8.next = 6;\n                return this.storyStore.loadStory({\n                  storyId: storyId\n                });\n              case 6:\n                _context8.t0 = _context8.sent;\n              case 7:\n                story = _context8.t0;\n                argNamesToReset = argNames || _toConsumableArray(new Set([].concat(_toConsumableArray(Object.keys(story.initialArgs)), _toConsumableArray(Object.keys(this.storyStore.args.get(storyId))))));\n                updatedArgs = argNamesToReset.reduce(function (acc, argName) {\n                  acc[argName] = story.initialArgs[argName];\n                  return acc;\n                }, {});\n                _context8.next = 12;\n                return this.onUpdateArgs({\n                  storyId: storyId,\n                  updatedArgs: updatedArgs\n                });\n              case 12:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n      function onResetArgs(_x5) {\n        return _onResetArgs.apply(this, arguments);\n      }\n      return onResetArgs;\n    }() // ForceReRender does not include a story id, so we simply must\n    // re-render all stories in case they are relevant\n  }, {\n    key: \"onForceReRender\",\n    value: function () {\n      var _onForceReRender = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9() {\n        return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                _context9.next = 2;\n                return Promise.all(this.storyRenders.map(function (r) {\n                  return r.rerender();\n                }));\n              case 2:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9, this);\n      }));\n      function onForceReRender() {\n        return _onForceReRender.apply(this, arguments);\n      }\n      return onForceReRender;\n    }()\n  }, {\n    key: \"onForceRemount\",\n    value: function () {\n      var _onForceRemount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee10(_ref7) {\n        var storyId;\n        return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                storyId = _ref7.storyId;\n                _context10.next = 3;\n                return Promise.all(this.storyRenders.filter(function (r) {\n                  return r.id === storyId;\n                }).map(function (r) {\n                  return r.remount();\n                }));\n              case 3:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this);\n      }));\n      function onForceRemount(_x6) {\n        return _onForceRemount.apply(this, arguments);\n      }\n      return onForceRemount;\n    }() // Used by docs' modernInlineRender to render a story to a given element\n    // Note this short-circuits the `prepare()` phase of the StoryRender,\n    // main to be consistent with the previous behaviour. In the future,\n    // we will change it to go ahead and load the story, which will end up being\n    // \"instant\", although async.\n  }, {\n    key: \"renderStoryToElement\",\n    value: function renderStoryToElement(story, element) {\n      var _this4 = this;\n      var render = new StoryRender(this.channel, this.storyStore, this.renderToDOM, this.inlineStoryCallbacks(story.id), story.id, 'docs', story);\n      render.renderToElement(element);\n      this.storyRenders.push(render);\n      return /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee11() {\n        return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                _context11.next = 2;\n                return _this4.teardownRender(render);\n              case 2:\n              case \"end\":\n                return _context11.stop();\n            }\n          }\n        }, _callee11);\n      }));\n    }\n  }, {\n    key: \"teardownRender\",\n    value: function () {\n      var _teardownRender = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee12(render) {\n        var _ref9,\n          viewModeChanged,\n          _args12 = arguments;\n        return _regeneratorRuntime.wrap(function _callee12$(_context12) {\n          while (1) {\n            switch (_context12.prev = _context12.next) {\n              case 0:\n                _ref9 = _args12.length > 1 && _args12[1] !== undefined ? _args12[1] : {}, viewModeChanged = _ref9.viewModeChanged;\n                this.storyRenders = this.storyRenders.filter(function (r) {\n                  return r !== render;\n                });\n                _context12.next = 4;\n                return render === null || render === void 0 ? void 0 : render.teardown({\n                  viewModeChanged: viewModeChanged\n                });\n              case 4:\n              case \"end\":\n                return _context12.stop();\n            }\n          }\n        }, _callee12, this);\n      }));\n      function teardownRender(_x7) {\n        return _teardownRender.apply(this, arguments);\n      }\n      return teardownRender;\n    }() // API\n  }, {\n    key: \"extract\",\n    value: function () {\n      var _extract = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee13(options) {\n        var _global$FEATURES4;\n        return _regeneratorRuntime.wrap(function _callee13$(_context13) {\n          while (1) {\n            switch (_context13.prev = _context13.next) {\n              case 0:\n                if (!this.previewEntryError) {\n                  _context13.next = 2;\n                  break;\n                }\n                throw this.previewEntryError;\n              case 2:\n                if (this.storyStore.projectAnnotations) {\n                  _context13.next = 4;\n                  break;\n                }\n                throw new Error(dedent(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"Failed to initialize Storybook.\\n      \\n      Do you have an error in your `preview.js`? Check your Storybook's browser console for errors.\"], [\"Failed to initialize Storybook.\\n      \\n      Do you have an error in your \\\\`preview.js\\\\`? Check your Storybook's browser console for errors.\"]))));\n              case 4:\n                if (!((_global$FEATURES4 = global.FEATURES) !== null && _global$FEATURES4 !== void 0 && _global$FEATURES4.storyStoreV7)) {\n                  _context13.next = 7;\n                  break;\n                }\n                _context13.next = 7;\n                return this.storyStore.cacheAllCSFFiles();\n              case 7:\n                return _context13.abrupt(\"return\", this.storyStore.extract(options));\n              case 8:\n              case \"end\":\n                return _context13.stop();\n            }\n          }\n        }, _callee13, this);\n      }));\n      function extract(_x8) {\n        return _extract.apply(this, arguments);\n      }\n      return extract;\n    }() // UTILITIES\n  }, {\n    key: \"inlineStoryCallbacks\",\n    value: function inlineStoryCallbacks(storyId) {\n      return {\n        showMain: function showMain() {},\n        showError: function showError(err) {\n          return logger.error(\"Error rendering docs story (\".concat(storyId, \")\"), err);\n        },\n        showException: function showException(err) {\n          return logger.error(\"Error rendering docs story (\".concat(storyId, \")\"), err);\n        }\n      };\n    }\n  }, {\n    key: \"renderPreviewEntryError\",\n    value: function renderPreviewEntryError(reason, err) {\n      this.previewEntryError = err;\n      logger.error(reason);\n      logger.error(err);\n      this.channel.emit(CONFIG_ERROR, err);\n    }\n  }]);\n  return Preview;\n}();","map":{"version":3,"names":["_templateObject","_templateObject2","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","o","minLen","_arrayLikeToArray","n","Object","prototype","toString","call","slice","constructor","name","Array","from","test","iter","Symbol","iterator","isArray","len","length","i","arr2","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","args","arguments","apply","err","undefined","_taggedTemplateLiteral","strings","raw","freeze","defineProperties","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","_createClass","protoProps","staticProps","dedent","global","SynchronousPromise","CONFIG_ERROR","FORCE_REMOUNT","FORCE_RE_RENDER","GLOBALS_UPDATED","RESET_STORY_ARGS","SET_GLOBALS","STORY_ARGS_UPDATED","STORY_INDEX_INVALIDATED","UPDATE_GLOBALS","UPDATE_STORY_ARGS","logger","addons","StoryStore","StoryRender","fetch","STORY_INDEX_PATH","Preview","_global$FEATURES","channel","serverChannel","storyStore","getStoryIndex","importFn","renderToDOM","storyRenders","previewEntryError","getChannel","FEATURES","storyStoreV7","hasServerChannel","getServerChannel","initialize","_ref","_this","getProjectAnnotations","setupListeners","getProjectAnnotationsOrRenderError","projectAnnotations","initializeWithProjectAnnotations","_this$serverChannel","on","onStoryIndexChanged","bind","onUpdateGlobals","onUpdateArgs","onResetArgs","onForceReRender","onForceRemount","_this2","Error","catch","renderPreviewEntryError","_global$FEATURES2","_this3","setProjectAnnotations","setInitialGlobals","storyIndexPromise","getStoryIndexFromServer","storyIndex","initializeWithStoryIndex","_setInitialGlobals","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","emitGlobals","stop","emit","globals","get","globalTypes","_getStoryIndexFromServer","_callee2","result","_callee2$","_context2","sent","status","abrupt","json","t0","text","t1","_global$FEATURES3","cache","_onGetProjectAnnotationsChanged","_callee3","_ref2","_callee3$","_context3","onGetProjectAnnotationsChanged","_x","_onStoryIndexChanged","_callee4","_callee4$","_context4","onStoriesChanged","_onStoriesChanged","_callee5","_ref3","_callee5$","_context5","_x2","_onUpdateGlobals","_callee6","_ref4","_callee6$","_context6","update","all","map","r","rerender","initialGlobals","_x3","_onUpdateArgs","_callee7","_ref5","storyId","updatedArgs","_callee7$","_context7","filter","id","_x4","_onResetArgs","_callee8","_ref6","argNames","render","story","argNamesToReset","_callee8$","_context8","find","loadStory","Set","concat","keys","initialArgs","reduce","acc","argName","_x5","_onForceReRender","_callee9","_callee9$","_context9","_onForceRemount","_callee10","_ref7","_callee10$","_context10","remount","_x6","renderStoryToElement","element","_this4","inlineStoryCallbacks","renderToElement","push","_callee11","_callee11$","_context11","teardownRender","_teardownRender","_callee12","_ref9","viewModeChanged","_args12","_callee12$","_context12","teardown","_x7","_extract","_callee13","options","_global$FEATURES4","_callee13$","_context13","cacheAllCSFFiles","extract","_x8","showMain","showError","showException","reason"],"sources":["/Users/michael.restrepo/code/personal/web-components/rimuru/node_modules/@storybook/preview-web/dist/esm/Preview.js"],"sourcesContent":["import \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.object.freeze.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\nimport \"core-js/modules/es.array.from.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\n\nvar _templateObject, _templateObject2;\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nimport \"regenerator-runtime/runtime.js\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.promise.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.set.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport dedent from 'ts-dedent';\nimport global from 'global';\nimport { SynchronousPromise } from 'synchronous-promise';\nimport { CONFIG_ERROR, FORCE_REMOUNT, FORCE_RE_RENDER, GLOBALS_UPDATED, RESET_STORY_ARGS, SET_GLOBALS, STORY_ARGS_UPDATED, STORY_INDEX_INVALIDATED, UPDATE_GLOBALS, UPDATE_STORY_ARGS } from '@storybook/core-events';\nimport { logger } from '@storybook/client-logger';\nimport { addons } from '@storybook/addons';\nimport { StoryStore } from '@storybook/store';\nimport { StoryRender } from './StoryRender';\nvar fetch = global.fetch;\nvar STORY_INDEX_PATH = './stories.json';\nexport var Preview = /*#__PURE__*/function () {\n  function Preview() {\n    var _global$FEATURES;\n\n    _classCallCheck(this, Preview);\n\n    this.channel = void 0;\n    this.serverChannel = void 0;\n    this.storyStore = void 0;\n    this.getStoryIndex = void 0;\n    this.importFn = void 0;\n    this.renderToDOM = void 0;\n    this.storyRenders = [];\n    this.previewEntryError = void 0;\n    this.channel = addons.getChannel();\n\n    if ((_global$FEATURES = global.FEATURES) !== null && _global$FEATURES !== void 0 && _global$FEATURES.storyStoreV7 && addons.hasServerChannel()) {\n      this.serverChannel = addons.getServerChannel();\n    }\n\n    this.storyStore = new StoryStore();\n  } // INITIALIZATION\n  // NOTE: the reason that the preview and store's initialization code is written in a promise\n  // style and not `async-await`, and the use of `SynchronousPromise`s is in order to allow\n  // storyshots to immediately call `raw()` on the store without waiting for a later tick.\n  // (Even simple things like `Promise.resolve()` and `await` involve the callback happening\n  // in the next promise \"tick\").\n  // See the comment in `storyshots-core/src/api/index.ts` for more detail.\n\n\n  _createClass(Preview, [{\n    key: \"initialize\",\n    value: function initialize(_ref) {\n      var _this = this;\n\n      var getStoryIndex = _ref.getStoryIndex,\n          importFn = _ref.importFn,\n          getProjectAnnotations = _ref.getProjectAnnotations;\n      // We save these two on initialization in case `getProjectAnnotations` errors,\n      // in which case we may need them later when we recover.\n      this.getStoryIndex = getStoryIndex;\n      this.importFn = importFn;\n      this.setupListeners();\n      return this.getProjectAnnotationsOrRenderError(getProjectAnnotations).then(function (projectAnnotations) {\n        return _this.initializeWithProjectAnnotations(projectAnnotations);\n      });\n    }\n  }, {\n    key: \"setupListeners\",\n    value: function setupListeners() {\n      var _this$serverChannel;\n\n      (_this$serverChannel = this.serverChannel) === null || _this$serverChannel === void 0 ? void 0 : _this$serverChannel.on(STORY_INDEX_INVALIDATED, this.onStoryIndexChanged.bind(this));\n      this.channel.on(UPDATE_GLOBALS, this.onUpdateGlobals.bind(this));\n      this.channel.on(UPDATE_STORY_ARGS, this.onUpdateArgs.bind(this));\n      this.channel.on(RESET_STORY_ARGS, this.onResetArgs.bind(this));\n      this.channel.on(FORCE_RE_RENDER, this.onForceReRender.bind(this));\n      this.channel.on(FORCE_REMOUNT, this.onForceRemount.bind(this));\n    }\n  }, {\n    key: \"getProjectAnnotationsOrRenderError\",\n    value: function getProjectAnnotationsOrRenderError(getProjectAnnotations) {\n      var _this2 = this;\n\n      return SynchronousPromise.resolve().then(getProjectAnnotations).then(function (projectAnnotations) {\n        _this2.renderToDOM = projectAnnotations.renderToDOM;\n\n        if (!_this2.renderToDOM) {\n          throw new Error(dedent(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n            Expected your framework's preset to export a `renderToDOM` field.\\n\\n            Perhaps it needs to be upgraded for Storybook 6.4?\\n\\n            More info: https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#mainjs-framework-field          \\n          \"], [\"\\n            Expected your framework's preset to export a \\\\`renderToDOM\\\\` field.\\n\\n            Perhaps it needs to be upgraded for Storybook 6.4?\\n\\n            More info: https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#mainjs-framework-field          \\n          \"]))));\n        }\n\n        return projectAnnotations;\n      }).catch(function (err) {\n        // This is an error extracting the projectAnnotations (i.e. evaluating the previewEntries) and\n        // needs to be show to the user as a simple error\n        _this2.renderPreviewEntryError('Error reading preview.js:', err);\n\n        throw err;\n      });\n    } // If initialization gets as far as project annotations, this function runs.\n\n  }, {\n    key: \"initializeWithProjectAnnotations\",\n    value: function initializeWithProjectAnnotations(projectAnnotations) {\n      var _global$FEATURES2,\n          _this3 = this;\n\n      this.storyStore.setProjectAnnotations(projectAnnotations);\n      this.setInitialGlobals();\n      var storyIndexPromise;\n\n      if ((_global$FEATURES2 = global.FEATURES) !== null && _global$FEATURES2 !== void 0 && _global$FEATURES2.storyStoreV7) {\n        storyIndexPromise = this.getStoryIndexFromServer();\n      } else {\n        if (!this.getStoryIndex) {\n          throw new Error('No `getStoryIndex` passed defined in v6 mode');\n        }\n\n        storyIndexPromise = SynchronousPromise.resolve().then(this.getStoryIndex);\n      }\n\n      return storyIndexPromise.then(function (storyIndex) {\n        return _this3.initializeWithStoryIndex(storyIndex);\n      }).catch(function (err) {\n        _this3.renderPreviewEntryError('Error loading story index:', err);\n\n        throw err;\n      });\n    }\n  }, {\n    key: \"setInitialGlobals\",\n    value: function () {\n      var _setInitialGlobals = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.emitGlobals();\n\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function setInitialGlobals() {\n        return _setInitialGlobals.apply(this, arguments);\n      }\n\n      return setInitialGlobals;\n    }()\n  }, {\n    key: \"emitGlobals\",\n    value: function emitGlobals() {\n      this.channel.emit(SET_GLOBALS, {\n        globals: this.storyStore.globals.get() || {},\n        globalTypes: this.storyStore.projectAnnotations.globalTypes || {}\n      });\n    }\n  }, {\n    key: \"getStoryIndexFromServer\",\n    value: function () {\n      var _getStoryIndexFromServer = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        var result;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return fetch(STORY_INDEX_PATH);\n\n              case 2:\n                result = _context2.sent;\n\n                if (!(result.status === 200)) {\n                  _context2.next = 5;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", result.json());\n\n              case 5:\n                _context2.t0 = Error;\n                _context2.next = 8;\n                return result.text();\n\n              case 8:\n                _context2.t1 = _context2.sent;\n                throw new _context2.t0(_context2.t1);\n\n              case 10:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      function getStoryIndexFromServer() {\n        return _getStoryIndexFromServer.apply(this, arguments);\n      }\n\n      return getStoryIndexFromServer;\n    }() // If initialization gets as far as the story index, this function runs.\n\n  }, {\n    key: \"initializeWithStoryIndex\",\n    value: function initializeWithStoryIndex(storyIndex) {\n      var _global$FEATURES3;\n\n      return this.storyStore.initialize({\n        storyIndex: storyIndex,\n        importFn: this.importFn,\n        cache: !((_global$FEATURES3 = global.FEATURES) !== null && _global$FEATURES3 !== void 0 && _global$FEATURES3.storyStoreV7)\n      });\n    } // EVENT HANDLERS\n    // This happens when a config file gets reloaded\n\n  }, {\n    key: \"onGetProjectAnnotationsChanged\",\n    value: function () {\n      var _onGetProjectAnnotationsChanged = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(_ref2) {\n        var getProjectAnnotations, projectAnnotations;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                getProjectAnnotations = _ref2.getProjectAnnotations;\n                delete this.previewEntryError;\n                _context3.next = 4;\n                return this.getProjectAnnotationsOrRenderError(getProjectAnnotations);\n\n              case 4:\n                projectAnnotations = _context3.sent;\n\n                if (this.storyStore.projectAnnotations) {\n                  _context3.next = 9;\n                  break;\n                }\n\n                _context3.next = 8;\n                return this.initializeWithProjectAnnotations(projectAnnotations);\n\n              case 8:\n                return _context3.abrupt(\"return\");\n\n              case 9:\n                _context3.next = 11;\n                return this.storyStore.setProjectAnnotations(projectAnnotations);\n\n              case 11:\n                this.emitGlobals();\n\n              case 12:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function onGetProjectAnnotationsChanged(_x) {\n        return _onGetProjectAnnotationsChanged.apply(this, arguments);\n      }\n\n      return onGetProjectAnnotationsChanged;\n    }()\n  }, {\n    key: \"onStoryIndexChanged\",\n    value: function () {\n      var _onStoryIndexChanged = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {\n        var storyIndex;\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                delete this.previewEntryError;\n\n                if (this.storyStore.projectAnnotations) {\n                  _context4.next = 3;\n                  break;\n                }\n\n                return _context4.abrupt(\"return\");\n\n              case 3:\n                _context4.prev = 3;\n                _context4.next = 6;\n                return this.getStoryIndexFromServer();\n\n              case 6:\n                storyIndex = _context4.sent;\n\n                if (this.storyStore.storyIndex) {\n                  _context4.next = 10;\n                  break;\n                }\n\n                _context4.next = 10;\n                return this.initializeWithStoryIndex(storyIndex);\n\n              case 10:\n                _context4.next = 12;\n                return this.onStoriesChanged({\n                  storyIndex: storyIndex\n                });\n\n              case 12:\n                _context4.next = 18;\n                break;\n\n              case 14:\n                _context4.prev = 14;\n                _context4.t0 = _context4[\"catch\"](3);\n                this.renderPreviewEntryError('Error loading story index:', _context4.t0);\n                throw _context4.t0;\n\n              case 18:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[3, 14]]);\n      }));\n\n      function onStoryIndexChanged() {\n        return _onStoryIndexChanged.apply(this, arguments);\n      }\n\n      return onStoryIndexChanged;\n    }() // This happens when a glob gets HMR-ed\n\n  }, {\n    key: \"onStoriesChanged\",\n    value: function () {\n      var _onStoriesChanged = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5(_ref3) {\n        var importFn, storyIndex;\n        return regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                importFn = _ref3.importFn, storyIndex = _ref3.storyIndex;\n                _context5.next = 3;\n                return this.storyStore.onStoriesChanged({\n                  importFn: importFn,\n                  storyIndex: storyIndex\n                });\n\n              case 3:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function onStoriesChanged(_x2) {\n        return _onStoriesChanged.apply(this, arguments);\n      }\n\n      return onStoriesChanged;\n    }()\n  }, {\n    key: \"onUpdateGlobals\",\n    value: function () {\n      var _onUpdateGlobals = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6(_ref4) {\n        var globals;\n        return regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                globals = _ref4.globals;\n                this.storyStore.globals.update(globals);\n                _context6.next = 4;\n                return Promise.all(this.storyRenders.map(function (r) {\n                  return r.rerender();\n                }));\n\n              case 4:\n                this.channel.emit(GLOBALS_UPDATED, {\n                  globals: this.storyStore.globals.get(),\n                  initialGlobals: this.storyStore.globals.initialGlobals\n                });\n\n              case 5:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function onUpdateGlobals(_x3) {\n        return _onUpdateGlobals.apply(this, arguments);\n      }\n\n      return onUpdateGlobals;\n    }()\n  }, {\n    key: \"onUpdateArgs\",\n    value: function () {\n      var _onUpdateArgs = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee7(_ref5) {\n        var storyId, updatedArgs;\n        return regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                storyId = _ref5.storyId, updatedArgs = _ref5.updatedArgs;\n                this.storyStore.args.update(storyId, updatedArgs);\n                _context7.next = 4;\n                return Promise.all(this.storyRenders.filter(function (r) {\n                  return r.id === storyId;\n                }).map(function (r) {\n                  return r.rerender();\n                }));\n\n              case 4:\n                this.channel.emit(STORY_ARGS_UPDATED, {\n                  storyId: storyId,\n                  args: this.storyStore.args.get(storyId)\n                });\n\n              case 5:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function onUpdateArgs(_x4) {\n        return _onUpdateArgs.apply(this, arguments);\n      }\n\n      return onUpdateArgs;\n    }()\n  }, {\n    key: \"onResetArgs\",\n    value: function () {\n      var _onResetArgs = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee8(_ref6) {\n        var storyId, argNames, render, story, argNamesToReset, updatedArgs;\n        return regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                storyId = _ref6.storyId, argNames = _ref6.argNames;\n                // NOTE: we have to be careful here and avoid await-ing when updating a rendered's args.\n                // That's because below in `renderStoryToElement` we have also bound to this event and will\n                // render the story in the same tick.\n                // However, we can do that safely as the current story is available in `this.storyRenders`\n                render = this.storyRenders.find(function (r) {\n                  return r.id === storyId;\n                });\n                _context8.t0 = render === null || render === void 0 ? void 0 : render.story;\n\n                if (_context8.t0) {\n                  _context8.next = 7;\n                  break;\n                }\n\n                _context8.next = 6;\n                return this.storyStore.loadStory({\n                  storyId: storyId\n                });\n\n              case 6:\n                _context8.t0 = _context8.sent;\n\n              case 7:\n                story = _context8.t0;\n                argNamesToReset = argNames || _toConsumableArray(new Set([].concat(_toConsumableArray(Object.keys(story.initialArgs)), _toConsumableArray(Object.keys(this.storyStore.args.get(storyId))))));\n                updatedArgs = argNamesToReset.reduce(function (acc, argName) {\n                  acc[argName] = story.initialArgs[argName];\n                  return acc;\n                }, {});\n                _context8.next = 12;\n                return this.onUpdateArgs({\n                  storyId: storyId,\n                  updatedArgs: updatedArgs\n                });\n\n              case 12:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n\n      function onResetArgs(_x5) {\n        return _onResetArgs.apply(this, arguments);\n      }\n\n      return onResetArgs;\n    }() // ForceReRender does not include a story id, so we simply must\n    // re-render all stories in case they are relevant\n\n  }, {\n    key: \"onForceReRender\",\n    value: function () {\n      var _onForceReRender = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee9() {\n        return regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                _context9.next = 2;\n                return Promise.all(this.storyRenders.map(function (r) {\n                  return r.rerender();\n                }));\n\n              case 2:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9, this);\n      }));\n\n      function onForceReRender() {\n        return _onForceReRender.apply(this, arguments);\n      }\n\n      return onForceReRender;\n    }()\n  }, {\n    key: \"onForceRemount\",\n    value: function () {\n      var _onForceRemount = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee10(_ref7) {\n        var storyId;\n        return regeneratorRuntime.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                storyId = _ref7.storyId;\n                _context10.next = 3;\n                return Promise.all(this.storyRenders.filter(function (r) {\n                  return r.id === storyId;\n                }).map(function (r) {\n                  return r.remount();\n                }));\n\n              case 3:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this);\n      }));\n\n      function onForceRemount(_x6) {\n        return _onForceRemount.apply(this, arguments);\n      }\n\n      return onForceRemount;\n    }() // Used by docs' modernInlineRender to render a story to a given element\n    // Note this short-circuits the `prepare()` phase of the StoryRender,\n    // main to be consistent with the previous behaviour. In the future,\n    // we will change it to go ahead and load the story, which will end up being\n    // \"instant\", although async.\n\n  }, {\n    key: \"renderStoryToElement\",\n    value: function renderStoryToElement(story, element) {\n      var _this4 = this;\n\n      var render = new StoryRender(this.channel, this.storyStore, this.renderToDOM, this.inlineStoryCallbacks(story.id), story.id, 'docs', story);\n      render.renderToElement(element);\n      this.storyRenders.push(render);\n      return /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee11() {\n        return regeneratorRuntime.wrap(function _callee11$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                _context11.next = 2;\n                return _this4.teardownRender(render);\n\n              case 2:\n              case \"end\":\n                return _context11.stop();\n            }\n          }\n        }, _callee11);\n      }));\n    }\n  }, {\n    key: \"teardownRender\",\n    value: function () {\n      var _teardownRender = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee12(render) {\n        var _ref9,\n            viewModeChanged,\n            _args12 = arguments;\n\n        return regeneratorRuntime.wrap(function _callee12$(_context12) {\n          while (1) {\n            switch (_context12.prev = _context12.next) {\n              case 0:\n                _ref9 = _args12.length > 1 && _args12[1] !== undefined ? _args12[1] : {}, viewModeChanged = _ref9.viewModeChanged;\n                this.storyRenders = this.storyRenders.filter(function (r) {\n                  return r !== render;\n                });\n                _context12.next = 4;\n                return render === null || render === void 0 ? void 0 : render.teardown({\n                  viewModeChanged: viewModeChanged\n                });\n\n              case 4:\n              case \"end\":\n                return _context12.stop();\n            }\n          }\n        }, _callee12, this);\n      }));\n\n      function teardownRender(_x7) {\n        return _teardownRender.apply(this, arguments);\n      }\n\n      return teardownRender;\n    }() // API\n\n  }, {\n    key: \"extract\",\n    value: function () {\n      var _extract = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee13(options) {\n        var _global$FEATURES4;\n\n        return regeneratorRuntime.wrap(function _callee13$(_context13) {\n          while (1) {\n            switch (_context13.prev = _context13.next) {\n              case 0:\n                if (!this.previewEntryError) {\n                  _context13.next = 2;\n                  break;\n                }\n\n                throw this.previewEntryError;\n\n              case 2:\n                if (this.storyStore.projectAnnotations) {\n                  _context13.next = 4;\n                  break;\n                }\n\n                throw new Error(dedent(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"Failed to initialize Storybook.\\n      \\n      Do you have an error in your `preview.js`? Check your Storybook's browser console for errors.\"], [\"Failed to initialize Storybook.\\n      \\n      Do you have an error in your \\\\`preview.js\\\\`? Check your Storybook's browser console for errors.\"]))));\n\n              case 4:\n                if (!((_global$FEATURES4 = global.FEATURES) !== null && _global$FEATURES4 !== void 0 && _global$FEATURES4.storyStoreV7)) {\n                  _context13.next = 7;\n                  break;\n                }\n\n                _context13.next = 7;\n                return this.storyStore.cacheAllCSFFiles();\n\n              case 7:\n                return _context13.abrupt(\"return\", this.storyStore.extract(options));\n\n              case 8:\n              case \"end\":\n                return _context13.stop();\n            }\n          }\n        }, _callee13, this);\n      }));\n\n      function extract(_x8) {\n        return _extract.apply(this, arguments);\n      }\n\n      return extract;\n    }() // UTILITIES\n\n  }, {\n    key: \"inlineStoryCallbacks\",\n    value: function inlineStoryCallbacks(storyId) {\n      return {\n        showMain: function showMain() {},\n        showError: function showError(err) {\n          return logger.error(\"Error rendering docs story (\".concat(storyId, \")\"), err);\n        },\n        showException: function showException(err) {\n          return logger.error(\"Error rendering docs story (\".concat(storyId, \")\"), err);\n        }\n      };\n    }\n  }, {\n    key: \"renderPreviewEntryError\",\n    value: function renderPreviewEntryError(reason, err) {\n      this.previewEntryError = err;\n      logger.error(reason);\n      logger.error(err);\n      this.channel.emit(CONFIG_ERROR, err);\n    }\n  }]);\n\n  return Preview;\n}();"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}